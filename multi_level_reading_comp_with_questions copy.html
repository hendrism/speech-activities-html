<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Multi-Level Reading Comprehension Tool</title>
<style>
  :root {
    --w: 1200px;
    --accent: #3b82f6;
    --bg: #f8fafc;
    --ink: #0f172a;
    --ok: #10b981;
    --err: #ef4444;
    --warning: #f59e0b;
    --purple: #8b5cf6;
    --gray: #64748b;
    --very-simple: #06b6d4;
    --simple: #22c55e;
    --middle: #f59e0b;
    --complex: #ef4444;
  }
  
  * { box-sizing: border-box; }
  
  body { 
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; 
    background: var(--bg); 
    color: var(--ink); 
    margin: 0; 
    line-height: 1.6;
    font-size: 16px;
  }
  
  header { 
    background: white; 
    border-bottom: 3px solid #e2e8f0; 
    position: sticky; 
    top: 0; 
    z-index: 10; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .bar { 
    max-width: var(--w); 
    margin: 0 auto; 
    padding: 20px; 
    display: grid; 
    grid-template-columns: 1fr auto; 
    gap: 20px; 
    align-items: center; 
  }
  
  .bar h1 { 
    font-size: 24px; 
    margin: 0; 
    color: var(--accent);
    font-weight: 700;
  }
  
  .controls { 
    display: flex; 
    gap: 12px; 
    align-items: center; 
    flex-wrap: wrap;
  }

  .teacher-info {
    background: #f1f5f9;
    border: 1px solid #cbd5e1;
    border-radius: 6px;
    padding: 4px 8px;
    font-size: 12px;
    color: var(--gray);
    font-weight: 500;
  }

  .teacher-info.very-simple { border-left: 4px solid var(--very-simple); }
  .teacher-info.simple { border-left: 4px solid var(--simple); }
  .teacher-info.middle { border-left: 4px solid var(--middle); }
  .teacher-info.complex { border-left: 4px solid var(--complex); }
  
  main { 
    max-width: var(--w); 
    margin: 30px auto; 
    padding: 0 20px; 
  }

  .setup-panel {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }

  .setup-section {
    margin-bottom: 25px;
  }

  .setup-section h3 {
    margin: 0 0 15px;
    color: var(--accent);
    font-size: 18px;
  }

  .level-selector {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 12px;
    margin-bottom: 20px;
  }

  .level-btn {
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s ease;
    border: 2px solid #cbd5e1;
    background: #f8fafc;
    cursor: pointer;
    text-align: left;
  }

  .level-btn.very-simple { border-color: var(--very-simple); }
  .level-btn.very-simple.active { background: var(--very-simple); color: white; }
  
  .level-btn.simple { border-color: var(--simple); }
  .level-btn.simple.active { background: var(--simple); color: white; }
  
  .level-btn.middle { border-color: var(--middle); }
  .level-btn.middle.active { background: var(--middle); color: white; }
  
  .level-btn.complex { border-color: var(--complex); }
  .level-btn.complex.active { background: var(--complex); color: white; }

  .level-btn .level-title {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 4px;
  }

  .level-btn .level-desc {
    font-size: 12px;
    opacity: 0.8;
  }

  .objectives-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 15px;
  }

  .objective-card {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 15px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .objective-card:hover {
    border-color: var(--accent);
    background: #eff6ff;
  }

  .objective-card.selected {
    border-color: var(--accent);
    background: #eff6ff;
  }

  .objective-card input[type="checkbox"] {
    margin-right: 10px;
    transform: scale(1.2);
  }

  .objective-title {
    font-weight: 600;
    margin-bottom: 5px;
    color: var(--ink);
  }

  .objective-desc {
    font-size: 14px;
    color: var(--gray);
    line-height: 1.4;
  }

  .story-selector {
    display: flex;
    gap: 12px;
    margin-bottom: 30px;
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .story-btn {
    padding: 12px 20px;
    border-radius: 25px;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s ease;
    border: 2px solid #cbd5e1;
    background: #f8fafc;
    cursor: pointer;
  }
  
  .story-btn.active {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
  }
  
  .activity-container {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    margin-bottom: 30px;
  }
  
  .story-header {
    text-align: center;
    margin-bottom: 30px;
  }
  
  .story-title {
    color: var(--accent);
    font-size: 28px;
    margin: 0 0 10px;
    font-weight: 700;
  }

  .story-picture {
    max-width: 400px;
    max-height: 300px;
    width: auto;
    height: auto;
    border-radius: 12px;
    margin: 20px auto;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    display: block;
    object-fit: contain;
  }
  
  .activity-toggle {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
  }
  
  .toggle-btn {
    padding: 12px 24px;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.2s ease;
    border: 2px solid #cbd5e1;
    background: #f8fafc;
    cursor: pointer;
  }
  
  .toggle-btn.active {
    background: var(--purple);
    color: white;
    border-color: var(--purple);
  }
  
  .story-text {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 30px;
    line-height: 1.7;
  }

  .story-text.very-simple { font-size: 18px; line-height: 2.0; }
  .story-text.simple { font-size: 16px; }
  .story-text.middle { font-size: 17px; }
  .story-text.complex { font-size: 18px; }
  
  .story-text p {
    margin: 0 0 20px;
  }
  
  .story-text p:last-child {
    margin-bottom: 0;
  }
  
  .activity-section {
    display: none;
  }
  
  .activity-section.active {
    display: block;
  }

  /* Main Idea Activity */
  .main-idea-choices {
    display: grid;
    gap: 15px;
    margin: 20px 0;
  }

  .main-idea-choice {
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 10px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 16px;
    line-height: 1.5;
  }

  .main-idea-choice:hover {
    border-color: var(--accent);
    background: #f8fafc;
  }

  .main-idea-choice.selected {
    border-color: var(--accent);
    background: #eff6ff;
  }

  .main-idea-choice.correct {
    border-color: var(--ok);
    background: #f0fdf4;
  }

  .main-idea-choice.incorrect {
    border-color: var(--err);
    background: #fef2f2;
  }

  /* Vocabulary Activity */
  .vocab-activity {
    max-width: 800px;
    margin: 0 auto;
  }
  
  .vocab-word {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 30px;
  }
  
  .vocab-word-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--purple);
    margin-bottom: 15px;
    text-align: center;
  }
  
  .vocab-sentence {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    font-size: 18px;
    line-height: 1.6;
  }
  
  .vocab-target {
    background: #ddd6fe;
    color: #5b21b6;
    padding: 3px 6px;
    border-radius: 4px;
    font-weight: 700;
  }

  .context-clues-section {
    background: #fef3c7;
    border: 2px solid var(--warning);
    border-radius: 8px;
    padding: 16px;
    margin: 15px 0;
    display: none;
  }

  .context-clues-section.show {
    display: block;
    animation: fadeIn 0.3s ease;
  }

  .context-clues-section h4 {
    color: #92400e;
    margin: 0 0 10px;
    font-size: 16px;
  }

  .clue-highlight {
    background: #fef3c7;
    padding: 2px 4px;
    border-radius: 3px;
    font-weight: 600;
  }

  .vocab-input {
    width: 100%;
    padding: 15px;
    border: 2px solid #cbd5e1;
    border-radius: 8px;
    font-size: 16px;
    margin: 15px 0;
    min-height: 120px;
    resize: vertical;
    font-family: inherit;
  }

  /* Sequence Activity */
  .sequence-activity {
    max-width: 800px;
    margin: 0 auto;
  }

  .sequence-prompt {
    background: #eff6ff;
    border: 2px solid var(--accent);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 25px;
    text-align: center;
  }

  .sequence-steps {
    display: grid;
    gap: 20px;
  }

  .sequence-step {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 20px;
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 15px;
    align-items: start;
  }

  .step-number {
    background: var(--accent);
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 18px;
    margin-top: 5px;
  }

  .step-content {
    display: grid;
    gap: 10px;
  }

  .sentence-starter {
    font-weight: 600;
    color: var(--accent);
    font-size: 16px;
  }

  .sentence-starter.expanded {
    color: var(--purple);
  }

  .sequence-input {
    width: 100%;
    padding: 12px;
    border: 2px solid #cbd5e1;
    border-radius: 8px;
    font-size: 16px;
    resize: vertical;
    min-height: 80px;
    font-family: inherit;
  }

  .step-help-section {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-top: 8px;
  }

  /* Comprehension Questions Activity */
  .comprehension-activity {
    max-width: 800px;
    margin: 0 auto;
  }

  .comprehension-prompt {
    background: #f0f9ff;
    border: 2px solid var(--accent);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 25px;
    text-align: center;
  }

  .comprehension-questions {
    display: grid;
    gap: 25px;
  }

  .comprehension-question {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 25px;
  }

  .question-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 15px;
  }

  .question-type {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
  }

  .question-type.literal {
    background: #dbeafe;
    color: #1e40af;
  }

  .question-type.inferential {
    background: #fef3c7;
    color: #92400e;
  }

  .question-text {
    font-size: 18px;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 15px;
  }

  .question-input {
    width: 100%;
    padding: 15px;
    border: 2px solid #cbd5e1;
    border-radius: 8px;
    font-size: 16px;
    resize: vertical;
    min-height: 100px;
    font-family: inherit;
    margin-bottom: 10px;
  }

  .question-help {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-top: 10px;
  }

  .question-hint {
    background: #fef3c7;
    border: 2px solid var(--warning);
    border-radius: 8px;
    padding: 12px;
    margin-top: 10px;
    display: none;
    font-size: 14px;
    color: #92400e;
  }

  .question-hint.show {
    display: block;
    animation: fadeIn 0.3s ease;
  }

  .question-feedback {
    margin-top: 15px;
    padding: 15px;
    border-radius: 8px;
    display: none;
  }

  .question-feedback.show {
    display: block;
  }

  .question-feedback.success {
    background: #f0fdf4;
    border: 2px solid var(--ok);
    color: #065f46;
  }

  .question-feedback.error {
    background: #fef2f2;
    border: 2px solid var(--err);
    color: #991b1b;
  }

  button {
    border: 2px solid #cbd5e1;
    background: #f8fafc;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.2s ease;
  }
  
  button:hover {
    background: #e2e8f0;
    border-color: #94a3b8;
  }
  
  button.primary {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
  }
  
  button.primary:hover {
    background: #2563eb;
  }
  
  button.success {
    background: var(--ok);
    color: white;
    border-color: var(--ok);
  }
  
  button.warning {
    background: var(--warning);
    color: white;
    border-color: var(--warning);
  }

  button.small {
    padding: 8px 16px;
    font-size: 14px;
  }
  
  .feedback {
    background: #f8fafc;
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
    display: none;
  }
  
  .feedback.show {
    display: block;
  }
  
  .feedback.success {
    background: #f0fdf4;
    border-color: var(--ok);
    color: #065f46;
  }
  
  .feedback.error {
    background: #fef2f2;
    border-color: var(--err);
    color: #991b1b;
  }

  .start-session-btn {
    background: linear-gradient(135deg, var(--accent), var(--purple));
    color: white;
    border: none;
    padding: 15px 30px;
    border-radius: 25px;
    font-size: 18px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-top: 20px;
  }

  .start-session-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  .start-session-btn:disabled {
    background: #cbd5e1;
    color: #64748b;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  /* Picture Upload Styles */
  .picture-upload {
    position: relative;
    display: none;
  }

  .picture-upload.show {
    display: block;
  }

  .picture-controls {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 15px;
    padding: 10px;
    background: #f1f5f9;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
  }

  .picture-input {
    display: none;
  }

  .remove-picture-btn {
    background: var(--err);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 12px;
    cursor: pointer;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @media (max-width: 768px) {
    .objectives-grid {
      grid-template-columns: 1fr;
    }
    
    .level-selector {
      grid-template-columns: 1fr;
    }
    
    .bar {
      grid-template-columns: 1fr;
      gap: 15px;
      text-align: center;
    }
    
    .controls {
      justify-content: center;
    }

    .activity-toggle {
      flex-direction: column;
      align-items: center;
    }

    .sequence-step {
      grid-template-columns: 1fr;
      text-align: center;
    }

    .step-number {
      justify-self: center;
      margin-bottom: 10px;
    }

    .picture-controls {
      flex-direction: column;
      align-items: stretch;
    }

    .story-picture {
      max-width: 300px;
      max-height: 200px;
    }
  }
</style>
</head>

<body>
  <header>
    <div class="bar">
      <h1>üìö Multi-Level Reading Comprehension Tool</h1>
      <div class="controls">
        <div class="teacher-info" id="teacherInfo" style="display:none;">Level: Simple</div>
        <button id="addPicture" class="small" style="display:none;">üì∑ Add Picture</button>
        <button id="backToSetup" class="warning" style="display:none;">‚Üê Back to Setup</button>
        <button id="resetActivity" class="warning" style="display:none;">üîÑ Reset</button>
      </div>
    </div>
  </header>

  <main>
    <!-- Setup Panel -->
    <div class="setup-panel" id="setupPanel">
      <div class="setup-section">
        <h3>1. Select Reading Level</h3>
        <div class="level-selector">
          <button class="level-btn very-simple active" data-level="very-simple">
            <div class="level-title">üü¶ Very Simple</div>
            <div class="level-desc">5 sentences, basic words, significant language support needed</div>
          </button>
          <button class="level-btn simple" data-level="simple">
            <div class="level-title">üü¢ Simple</div>
            <div class="level-desc">Short paragraphs, basic vocabulary, ages 10-12</div>
          </button>
          <button class="level-btn middle" data-level="middle">
            <div class="level-title">üü° Middle</div>
            <div class="level-desc">Grade-level vocabulary and complexity, ages 12-14</div>
          </button>
          <button class="level-btn complex" data-level="complex">
            <div class="level-title">üî¥ Complex</div>
            <div class="level-desc">Advanced vocabulary and sentence structure, ages 14+</div>
          </button>
        </div>
      </div>

      <div class="setup-section">
        <h3>2. Select Learning Objectives (Multi-select)</h3>
        <div class="objectives-grid">
          <div class="objective-card" data-objective="main-idea">
            <input type="checkbox" id="obj-main-idea">
            <label for="obj-main-idea" class="objective-title">Main Idea Identification</label>
            <div class="objective-desc">Name the main idea of a passage when given three answer choices</div>
          </div>
          <div class="objective-card" data-objective="context-clues">
            <input type="checkbox" id="obj-context-clues">
            <label for="obj-context-clues" class="objective-title">Context Clues Vocabulary</label>
            <div class="objective-desc">Use context clues to determine the meaning of an unknown word</div>
          </div>
          <div class="objective-card" data-objective="sequence">
            <input type="checkbox" id="obj-sequence">
            <label for="obj-sequence" class="objective-title">Story Sequence Retelling</label>
            <div class="objective-desc">Retell a 3-4 part sequence using sentence starters</div>
          </div>
          <div class="objective-card" data-objective="comprehension">
            <input type="checkbox" id="obj-comprehension">
            <label for="obj-comprehension" class="objective-title">Reading Comprehension Questions</label>
            <div class="objective-desc">Answer literal and inferential questions about the story</div>
          </div>
        </div>
      </div>

      <div style="text-align: center;">
        <button class="start-session-btn" id="startSession" disabled>
          üöÄ Start Reading Session
        </button>
        <div id="selectionSummary" style="margin-top: 15px; color: var(--gray); font-size: 14px;">
          Select a reading level and at least one objective to begin
        </div>
      </div>
    </div>

    <!-- Main Activity Area (Initially Hidden) -->
    <div id="mainActivity" style="display: none;">
      <div class="story-selector" id="storySelector">
        <!-- Story buttons will be generated -->
      </div>

      <div class="activity-container">
        <div class="story-header">
          <h2 class="story-title" id="storyTitle">Story Title</h2>
          
          <div class="picture-upload" id="pictureUpload">
            <div class="picture-controls">
              <input type="file" class="picture-input" id="pictureInput" accept="image/*">
              <label for="pictureInput" class="small" style="cursor: pointer; padding: 6px 12px; background: var(--accent); color: white; border-radius: 6px; font-size: 12px;">Choose Image</label>
              <span id="pictureFileName" style="font-size: 12px; color: var(--gray);"></span>
              <button class="remove-picture-btn" id="removePicture">Remove</button>
            </div>
            <img id="storyPicture" class="story-picture" style="display: none;" alt="Story picture">
          </div>
        </div>

        <div class="activity-toggle" id="activityToggle">
          <!-- Activity buttons will be generated based on selected objectives -->
        </div>

        <div class="story-text" id="storyText">
          <!-- Story content will be populated here -->
        </div>

        <!-- Main Idea Activity -->
        <div class="activity-section" id="mainIdeaSection">
          <h3>üéØ What is the main idea of this story?</h3>
          <div class="main-idea-choices" id="mainIdeaChoices">
            <!-- Choices will be populated here -->
          </div>
          <button id="checkMainIdea" class="primary">‚úì Check Answer</button>
          <div class="feedback" id="mainIdeaFeedback"></div>
        </div>

        <!-- Context Clues Vocabulary Activity -->
        <div class="activity-section" id="contextCluesSection">
          <div class="vocab-activity" id="contextCluesActivity">
            <!-- Context clues activities will be populated here -->
          </div>
        </div>

        <!-- Sequence Activity -->
        <div class="activity-section" id="sequenceSection">
          <div class="sequence-activity">
            <div class="sequence-prompt">
              <h3>üìù Retell this story in order</h3>
              <p>Use the sentence starters to help you retell what happened in the story. Write 1-2 sentences for each step.</p>
            </div>
            <div class="sequence-steps" id="sequenceSteps">
              <!-- Sequence steps will be populated here -->
            </div>
            <button id="checkSequence" class="primary" style="margin-top: 20px;">‚úì Check My Retelling</button>
            <div class="feedback" id="sequenceFeedback"></div>
          </div>
        </div>

        <!-- Comprehension Questions Activity -->
        <div class="activity-section" id="comprehensionSection">
          <div class="comprehension-activity">
            <div class="comprehension-prompt">
              <h3>ü§î Reading Comprehension Questions</h3>
              <p>Answer these questions about the story. Some answers can be found directly in the text, while others require you to think and make connections.</p>
            </div>
            <div class="comprehension-questions" id="comprehensionQuestions">
              <!-- Questions will be populated here -->
            </div>
            <button id="checkComprehension" class="primary" style="margin-top: 20px;">‚úì Check My Answers</button>
            <div class="feedback" id="comprehensionFeedback"></div>
          </div>
        </div>
      </div>
    </div>
  </main>

<script>
// Story data with four reading levels and activities
const storyData = {
  "garden": {
    title: "The Garden Project",
    "very-simple": {
      text: `Alex wanted to grow plants. Alex got seeds at the store. Alex planted the seeds in dirt. The plants grew big. Alex was happy.`,
      mainIdea: {
        question: "What did Alex do?",
        choices: [
          "Alex grew plants",
          "Alex went to the store", 
          "Alex was happy"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "planted",
          sentence: "Alex planted the seeds in dirt.",
          context: "Alex put the seeds in the ground so they could grow.",
          clues: ["put in ground", "so they could grow"],
          question: "What does 'planted' mean?",
          answer: "put seeds in the ground"
        },
        {
          word: "seeds",
          sentence: "Alex got seeds at the store.",
          context: "Alex bought these small things that grow into plants.",
          clues: ["grow into plants", "got at the store"],
          question: "What are 'seeds'?",
          answer: "small things that grow into plants"
        }
      ],
      sequence: [
        { basic: "First, Alex...", expanded: "First, Alex wanted to..." },
        { basic: "Next, Alex...", expanded: "Next, Alex got..." },
        { basic: "Then, Alex...", expanded: "Then, Alex planted..." },
        { basic: "Finally, Alex...", expanded: "Finally, Alex was..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "Where did Alex get the seeds?",
          hint: "Look for where Alex went to get things.",
          answer: "At the store"
        },
        {
          type: "literal", 
          question: "What did Alex plant in the dirt?",
          hint: "What did Alex put in the ground?",
          answer: "Seeds"
        },
        {
          type: "inferential",
          question: "Why was Alex happy at the end?",
          hint: "Think about what Alex wanted to do and what happened.",
          answer: "Because the plants grew / Alex succeeded in growing plants"
        },
        {
          type: "inferential",
          question: "What do you think Alex learned from this experience?",
          hint: "Think about what happens when you work hard at something.",
          answer: "That hard work pays off / You can grow things if you try"
        }
      ]
    },
    simple: {
      text: `Alex wanted to grow plants for a school project. The teacher said students could choose any science topic they wanted. Alex thought gardening would be fun and educational.

Alex asked Mom and Dad to help buy supplies at the garden store. They bought tomato seeds, bean seeds, and a small shovel. Alex also picked out some plant food to help the vegetables grow better.

At home, Alex prepared a small garden area in the backyard. Alex watered the plants every morning before school. After several weeks, tiny green plants started to appear. Alex felt excited to see the first vegetables growing.

By the end of the school term, Alex had grown enough vegetables to share with the whole family. The teacher was impressed and gave Alex an excellent grade on the project.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Alex completed a successful garden project for school",
          "Alex's family enjoyed eating homegrown vegetables",
          "Gardening requires expensive supplies and daily care"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "supplies",
          sentence: "Alex asked Mom and Dad to help buy supplies at the garden store.",
          context: "Alex needed different materials and tools to start the garden project.",
          clues: ["needed", "materials and tools", "for the garden"],
          question: "What are 'supplies'?",
          answer: "materials and tools needed for a project"
        },
        {
          word: "impressed",
          sentence: "The teacher was impressed and gave Alex an excellent grade on the project.",
          context: "The teacher thought Alex did really good work and felt proud of what Alex accomplished.",
          clues: ["thought Alex did good work", "felt proud", "gave excellent grade"],
          question: "What does 'impressed' mean?",
          answer: "pleased by someone's good work"
        }
      ],
      sequence: [
        { basic: "First, Alex...", expanded: "First, Alex decided to..." },
        { basic: "Next, Alex...", expanded: "Next, Alex went shopping and..." },
        { basic: "Then, Alex...", expanded: "Then, Alex planted and..." },
        { basic: "Finally, Alex...", expanded: "Finally, Alex shared and..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What project was Alex doing for school?",
          hint: "Look at the first paragraph for what Alex chose to do.",
          answer: "A garden project / gardening for science"
        },
        {
          type: "literal",
          question: "What did Alex buy at the garden store?",
          hint: "Find the sentence that lists what they purchased.",
          answer: "Tomato seeds, bean seeds, a small shovel, and plant food"
        },
        {
          type: "literal",
          question: "How did the teacher react to Alex's project?",
          hint: "Look at the last paragraph for the teacher's response.",
          answer: "The teacher was impressed and gave Alex an excellent grade"
        },
        {
          type: "inferential",
          question: "Why do you think Alex chose gardening for the science project?",
          hint: "Think about what the story tells us about Alex's feelings toward gardening.",
          answer: "Because Alex thought it would be fun and educational"
        },
        {
          type: "inferential",
          question: "What character traits did Alex show throughout this project?",
          hint: "Think about how Alex acted from planning to completion.",
          answer: "Responsibility, dedication, hard work, and perseverance"
        }
      ]
    },
    middle: {
      text: `Alex had always been interested in gardening but had never attempted it before. When their science teacher announced a project about plant growth and development, Alex recognized this as the perfect opportunity to start their first garden.

Alex spent considerable time researching which vegetables would thrive in their local climate. They convinced their parents to visit the garden center, where they carefully selected heritage tomato plants, organic bean seeds, and essential gardening equipment.

At home, Alex diligently prepared a 4-foot by 6-foot plot in the backyard. They established a consistent watering routine each morning and monitored the plants' progress daily. When the first vegetables began to mature, Alex felt tremendous satisfaction from their agricultural efforts.

By the conclusion of the term, Alex had cultivated enough vegetables to supply their entire family and earned an outstanding grade on their science project. The experience taught Alex valuable lessons about patience, responsibility, and the rewards of hard work.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Alex successfully completed a challenging garden project that taught valuable life lessons",
          "Garden centers provide all the necessary equipment for successful home gardening",
          "Science teachers should assign more hands-on projects for student learning"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "heritage",
          sentence: "They carefully selected heritage tomato plants, organic bean seeds, and essential gardening equipment.",
          context: "Alex chose special tomato plants that were old varieties passed down from earlier generations of gardeners.",
          clues: ["special", "old varieties", "passed down from earlier generations"],
          question: "What does 'heritage' mean in this context?",
          answer: "traditional varieties passed down through generations"
        },
        {
          word: "cultivated",
          sentence: "By the conclusion of the term, Alex had cultivated enough vegetables to supply their entire family.",
          context: "Alex had grown and cared for the vegetables with skill and attention until they were ready to harvest.",
          clues: ["grown and cared for", "with skill and attention", "ready to harvest"],
          question: "What does 'cultivated' mean?",
          answer: "grown and cared for plants with skill"
        }
      ],
      sequence: [
        { basic: "First, Alex...", expanded: "First, Alex recognized the opportunity to..." },
        { basic: "Next, Alex...", expanded: "Next, Alex researched and purchased..." },
        { basic: "Then, Alex...", expanded: "Then, Alex prepared the garden and..." },
        { basic: "Finally, Alex...", expanded: "Finally, Alex succeeded by..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What size plot did Alex prepare in the backyard?",
          hint: "Look for the specific measurements mentioned in the text.",
          answer: "4-foot by 6-foot plot"
        },
        {
          type: "literal",
          question: "What types of plants did Alex choose to grow?",
          hint: "Find the sentence about what Alex selected at the garden center.",
          answer: "Heritage tomato plants and organic bean seeds"
        },
        {
          type: "literal",
          question: "What three things did the experience teach Alex?",
          hint: "Look at the last sentence for the lessons learned.",
          answer: "Patience, responsibility, and the rewards of hard work"
        },
        {
          type: "inferential",
          question: "Why do you think Alex spent considerable time researching which vegetables to grow?",
          hint: "Consider what factors might affect plant growth in different areas.",
          answer: "To ensure the vegetables would thrive in their local climate and be successful"
        },
        {
          type: "inferential",
          question: "How did Alex's approach to this project demonstrate scientific thinking?",
          hint: "Think about the steps Alex took and how they mirror scientific methods.",
          answer: "Alex researched, planned, established consistent routines, monitored progress, and evaluated results"
        }
      ]
    },
    complex: {
      text: `Alex had maintained a profound fascination with botanical sciences but had never ventured into practical horticulture. When their science instructor announced a comprehensive project examining plant development and growth cycles, Alex recognized this as an unprecedented opportunity to establish their inaugural garden.

Through meticulous research, Alex investigated which cultivars would flourish in their geographical region's specific climate and soil conditions. They persuaded their parents to accompany them to the local agricultural nursery, where they methodically selected heirloom tomato varieties, certified organic legume seeds, and professional-grade horticultural implements.

Upon returning home, Alex meticulously prepared a precisely measured cultivation area in their backyard. They maintained a rigorous irrigation schedule each morning and conducted systematic assessments of their plants' developmental progress. When the initial harvest began to reach maturation, Alex experienced tremendous gratification from their agricultural accomplishments.

By the semester's conclusion, Alex had produced a substantial yield sufficient to nourish their entire household while simultaneously earning exemplary academic recognition. This endeavor demonstrated that dedication, scientific methodology, and perseverance can transform ambitious goals into tangible achievements.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Alex successfully executed a comprehensive horticultural project that demonstrated scientific principles and personal growth",
          "Professional-grade agricultural equipment is essential for successful home cultivation projects",
          "Academic institutions should emphasize practical applications of theoretical scientific concepts"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "horticulture",
          sentence: "Alex had maintained a profound fascination with botanical sciences but had never ventured into practical horticulture.",
          context: "Alex loved studying plants and flowers but had never tried the actual hands-on work of growing and caring for them.",
          clues: ["studying plants", "actual hands-on work", "growing and caring for them"],
          question: "What does 'horticulture' mean?",
          answer: "the art and science of growing plants and gardens"
        },
        {
          word: "methodology",
          sentence: "This endeavor demonstrated that dedication, scientific methodology, and perseverance can transform ambitious goals into tangible achievements.",
          context: "Alex's success showed that using careful, step-by-step scientific approaches and methods leads to real results.",
          clues: ["using careful", "step-by-step scientific approaches", "leads to real results"],
          question: "What does 'methodology' mean?",
          answer: "a system of methods and principles for doing something"
        }
      ],
      sequence: [
        { basic: "Initially, Alex...", expanded: "Initially, Alex recognized the unprecedented opportunity to..." },
        { basic: "Subsequently, Alex...", expanded: "Subsequently, Alex conducted research and..." },
        { basic: "Following this, Alex...", expanded: "Following this preparation, Alex established..." },
        { basic: "Ultimately, Alex...", expanded: "Ultimately, Alex achieved success through..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What specific academic outcome did Alex achieve from this project?",
          hint: "Look for information about Alex's grade and recognition.",
          answer: "Alex earned exemplary academic recognition / outstanding results"
        },
        {
          type: "literal",
          question: "What was Alex's previous experience with practical horticulture?",
          hint: "Find the information about Alex's background in hands-on gardening.",
          answer: "Alex had never ventured into practical horticulture before"
        },
        {
          type: "inferential",
          question: "Analyze how Alex's approach exemplified scientific methodology.",
          hint: "Consider the systematic steps Alex took and how they reflect scientific principles.",
          answer: "Alex used systematic research, hypothesis formation, controlled variables, observation, and documentation - all hallmarks of scientific methodology"
        },
        {
          type: "inferential",
          question: "What broader life principles does this narrative demonstrate about achieving ambitious goals?",
          hint: "Think about the abstract lessons that extend beyond gardening.",
          answer: "That dedication, scientific methodology, and perseverance can transform ambitious goals into tangible achievements"
        },
        {
          type: "inferential",
          question: "How does Alex's project bridge theoretical knowledge and practical application?",
          hint: "Consider how Alex moved from abstract interest to concrete results.",
          answer: "Alex applied botanical knowledge through hands-on experimentation, demonstrating that theoretical understanding combined with practical work yields meaningful outcomes"
        }
      ]
    }
  },
  "talent_show": {
    title: "The Talent Show",
    "very-simple": {
      text: `Maya plays piano. Maya wanted to be in the show. Maya practiced every day. Maya played at tryouts. Maya got picked for the show.`,
      mainIdea: {
        question: "What happened to Maya?",
        choices: [
          "Maya got in the talent show",
          "Maya learned to play piano",
          "Maya went to school"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "tryouts",
          sentence: "Maya played at tryouts.",
          context: "Maya had to play piano to see if she could be in the show.",
          clues: ["play piano", "see if she could be in show"],
          question: "What are 'tryouts'?",
          answer: "when you try to get into something"
        },
        {
          word: "practiced",
          sentence: "Maya practiced every day.",
          context: "Maya played piano over and over to get better.",
          clues: ["played over and over", "to get better"],
          question: "What does 'practiced' mean?",
          answer: "did something over and over to get better"
        }
      ],
      sequence: [
        { basic: "First, Maya...", expanded: "First, Maya wanted to..." },
        { basic: "Next, Maya...", expanded: "Next, Maya practiced..." },
        { basic: "Then, Maya...", expanded: "Then, Maya played at..." },
        { basic: "Finally, Maya...", expanded: "Finally, Maya got..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What instrument does Maya play?",
          hint: "Look at the first sentence.",
          answer: "Piano"
        },
        {
          type: "literal", 
          question: "How often did Maya practice?",
          hint: "Find the sentence about when Maya practiced.",
          answer: "Every day"
        },
        {
          type: "inferential",
          question: "How do you think Maya felt when she got picked?",
          hint: "Think about what Maya wanted and what happened.",
          answer: "Happy, excited, proud"
        },
        {
          type: "inferential",
          question: "What helped Maya get into the show?",
          hint: "Think about what Maya did before tryouts.",
          answer: "Practicing every day / hard work"
        }
      ]
    },
    simple: {
      text: `Maya had been playing piano for two years and wanted to be in the school talent show. She had never performed in front of a large audience before and felt worried about making mistakes.

Maya practiced her favorite song every day after school for three weeks. Her piano teacher helped her with the difficult parts and gave her tips for staying calm. Maya also played for her family to get used to performing for others.

On audition day, Maya felt nervous but was well-prepared. She played her song with only one small error that most people didn't notice. The judges smiled and nodded during her performance.

A week later, Maya was thrilled to see her name on the list of selected performers. She had earned her spot in the talent show through hard work and determination.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Maya prepared carefully and successfully earned a place in the talent show",
          "Piano teachers provide valuable support for nervous student performers",
          "School talent shows are difficult competitions that cause student stress"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "audition",
          sentence: "On audition day, Maya felt nervous but was well-prepared.",
          context: "Maya had to perform her piano song for the judges so they could decide if she was good enough for the show.",
          clues: ["perform for judges", "decide if good enough", "for the show"],
          question: "What is an 'audition'?",
          answer: "a tryout where you perform to show your skills"
        },
        {
          word: "determination",
          sentence: "She had earned her spot in the talent show through hard work and determination.",
          context: "Maya succeeded because she didn't give up and kept working toward her goal even when it was difficult.",
          clues: ["didn't give up", "kept working toward goal", "even when difficult"],
          question: "What does 'determination' mean?",
          answer: "not giving up and working hard toward a goal"
        }
      ],
      sequence: [
        { basic: "First, Maya...", expanded: "First, Maya wanted to..." },
        { basic: "Next, Maya...", expanded: "Next, Maya practiced by..." },
        { basic: "Then, Maya...", expanded: "Then, Maya went to auditions and..." },
        { basic: "Finally, Maya...", expanded: "Finally, Maya found out that..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "How long had Maya been playing piano when the story began?",
          hint: "Check the first sentence for Maya's experience level.",
          answer: "Two years"
        },
        {
          type: "literal",
          question: "How long did Maya practice for the talent show?",
          hint: "Look for the time period mentioned for her preparation.",
          answer: "Three weeks"
        },
        {
          type: "literal",
          question: "What mistake did Maya make during her audition?",
          hint: "Find the sentence about her performance during the audition.",
          answer: "One small error that most people didn't notice"
        },
        {
          type: "inferential",
          question: "Why do you think Maya's teacher suggested playing for her family first?",
          hint: "Think about how performing for different audiences might help someone.",
          answer: "To help Maya get used to performing for others and build confidence gradually"
        },
        {
          type: "inferential",
          question: "What does this story teach about achieving goals?",
          hint: "Consider what Maya did and how it led to her success.",
          answer: "Hard work, preparation, and determination lead to success"
        }
      ]
    },
    middle: {
      text: `Maya had been studying piano for three years but had never performed before a substantial audience. When announcements mentioned auditions for the annual school talent show, Maya experienced both excitement and anxiety about this challenging opportunity.

Maya was working on a classical piece called "F√ºr Elise" by Beethoven that required considerable skill. She realized she needed intensive practice to feel confident performing it publicly. For three weeks, Maya dedicated herself to rehearsing the piece daily for at least an hour after school.

Her piano instructor suggested performing for gradually larger groups to build her confidence. Maya followed this advice systematically, playing first for her family, then her best friend, and eventually her entire piano class.

On audition day, Maya approached the piano with composure despite her nervousness. She delivered a polished performance with only one minor technical mistake. The judges responded positively throughout, and when results were announced a week later, Maya was delighted to discover her name among the selected performers.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Maya overcame her performance anxiety through systematic preparation and earned recognition for her musical abilities",
          "Classical piano pieces require extensive professional instruction and expensive equipment for success",
          "School talent competitions create unnecessary academic pressure for developing student musicians"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "composure",
          sentence: "On audition day, Maya approached the piano with composure despite her nervousness.",
          context: "Maya was able to stay calm and controlled on the outside even though she felt worried inside.",
          clues: ["stay calm and controlled", "on the outside", "even though worried inside"],
          question: "What does 'composure' mean?",
          answer: "staying calm and controlled under pressure"
        },
        {
          word: "systematically",
          sentence: "Maya followed this advice systematically, playing first for her family, then her best friend, and eventually her entire piano class.",
          context: "Maya followed a careful, organized plan with specific steps in the right order to build her confidence.",
          clues: ["careful, organized plan", "specific steps", "in the right order"],
          question: "What does 'systematically' mean?",
          answer: "following a careful, organized plan with specific steps"
        }
      ],
      sequence: [
        { basic: "Initially, Maya...", expanded: "Initially, Maya felt nervous about..." },
        { basic: "To prepare, Maya...", expanded: "To prepare, Maya practiced and..." },
        { basic: "During the audition, Maya...", expanded: "During the audition, Maya performed..." },
        { basic: "Ultimately, Maya...", expanded: "Ultimately, Maya succeeded when..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What specific piece was Maya working on for her audition?",
          hint: "Look for the name of the classical composition mentioned.",
          answer: "F√ºr Elise by Beethoven"
        },
        {
          type: "literal",
          question: "How did Maya's instructor suggest she build confidence?",
          hint: "Find the advice about performing for different groups.",
          answer: "Performing for gradually larger groups to build confidence"
        },
        {
          type: "literal",
          question: "How did Maya follow this advice systematically?",
          hint: "Look for the sequence of audiences Maya performed for.",
          answer: "She played first for her family, then her best friend, and eventually her entire piano class"
        },
        {
          type: "inferential",
          question: "Why do you think the instructor recommended gradually larger audiences?",
          hint: "Consider the psychology behind building performance confidence.",
          answer: "To help Maya overcome anxiety by gradually increasing exposure, making the final audition feel more manageable"
        },
        {
          type: "inferential",
          question: "How does Maya's systematic approach reflect mature goal-setting strategies?",
          hint: "Think about what makes Maya's preparation method effective.",
          answer: "Maya broke down a large goal into smaller, manageable steps and built skills progressively"
        }
      ]
    },
    complex: {
      text: `Maya had been pursuing classical piano instruction for three years but had never undertaken a performance before a substantial audience. When administrative announcements publicized auditions for the institution's prestigious annual talent exhibition, Maya experienced simultaneous exhilaration and trepidation regarding this unprecedented opportunity.

Maya had been mastering Beethoven's intricate composition "F√ºr Elise," recognizing that additional intensive preparation would be essential for confident public presentation. She embarked upon a rigorous three-week practice regimen, dedicating no fewer than sixty minutes daily to perfecting the piece's technical complexities and musical interpretation.

Her instructor recommended graduated exposure to progressively larger audiences to ameliorate performance anxiety. Maya methodically implemented this strategy, beginning with intimate family presentations, advancing to individual peer demonstrations, and culminating with performances before her complete piano ensemble.

On the decisive audition date, Maya approached the instrument with remarkable poise despite experiencing considerable nervous tension. She delivered a compelling interpretation with merely one inconsequential technical imperfection. The adjudicating panel maintained visibly appreciative engagement throughout her presentation, and upon publication of results one week subsequently, Maya experienced profound satisfaction discovering her selection among the distinguished performers.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Maya systematically conquered performance anxiety through methodical preparation and achieved prestigious musical recognition",
          "Prestigious institutional talent exhibitions require extensive financial investment and professional musical instruction",
          "Academic institutions should provide comprehensive performance anxiety counseling for developing student musicians"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "ameliorate",
          sentence: "Her instructor recommended graduated exposure to progressively larger audiences to ameliorate performance anxiety.",
          context: "The instructor suggested a method to make Maya's nervousness about performing become less severe or troublesome.",
          clues: ["make nervousness", "become less severe", "less troublesome"],
          question: "What does 'ameliorate' mean?",
          answer: "to make something bad or unpleasant less severe"
        },
        {
          word: "inconsequential",
          sentence: "She delivered a compelling interpretation with merely one inconsequential technical imperfection.",
          context: "Maya made only one small mistake that wasn't important enough to affect her overall performance or the judges' opinion.",
          clues: ["one small mistake", "wasn't important enough", "didn't affect overall performance"],
          question: "What does 'inconsequential' mean?",
          answer: "not important enough to matter or make a difference"
        }
      ],
      sequence: [
        { basic: "Initially, Maya...", expanded: "Initially, Maya confronted the challenge of..." },
        { basic: "Through preparation, Maya...", expanded: "Through systematic preparation, Maya implemented..." },
        { basic: "During the audition, Maya...", expanded: "During the pivotal audition, Maya demonstrated..." },
        { basic: "Consequently, Maya...", expanded: "Consequently, Maya achieved recognition by..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What was the instructor's specific recommendation for addressing performance anxiety?",
          hint: "Look for the technical term used to describe the confidence-building strategy.",
          answer: "Graduated exposure to progressively larger audiences"
        },
        {
          type: "literal",
          question: "How did Maya implement this strategy methodically?",
          hint: "Find the sequence describing Maya's systematic approach to audience exposure.",
          answer: "Beginning with intimate family presentations, advancing to individual peer demonstrations, and culminating with performances before her complete piano ensemble"
        },
        {
          type: "literal",
          question: "What was the nature of Maya's technical error during the audition?",
          hint: "Look for the specific descriptor of her mistake during the performance.",
          answer: "One inconsequential technical imperfection"
        },
        {
          type: "inferential",
          question: "Analyze the psychological principles underlying the instructor's graduated exposure recommendation.",
          hint: "Consider why systematic exposure to increasing challenges builds confidence.",
          answer: "Graduated exposure allows for systematic desensitization to anxiety triggers while building competence and self-efficacy through successful experiences"
        },
        {
          type: "inferential",
          question: "How does Maya's experience exemplify the integration of technical skill development with psychological preparation?",
          hint: "Think about how Maya addressed both musical and emotional aspects of performance.",
          answer: "Maya combined intensive technical practice with strategic psychological conditioning, demonstrating that peak performance requires both skill mastery and mental preparation"
        }
      ]
    }
  },
  "mystery": {
    title: "The Missing Lunch Mystery",
    "very-simple": {
      text: `Kids lost their lunch food. The teacher looked for clues. A squirrel was taking the food. The teacher fixed the window. The mystery was solved.`,
      mainIdea: {
        question: "Who took the lunch food?",
        choices: [
          "A squirrel took the food",
          "The teacher took the food",
          "The kids took the food"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "clues",
          sentence: "The teacher looked for clues.",
          context: "The teacher looked for things to help solve the mystery.",
          clues: ["looked for things", "solve the mystery"],
          question: "What are 'clues'?",
          answer: "things that help you solve a mystery"
        },
        {
          word: "mystery",
          sentence: "The mystery was solved.",
          context: "The puzzle about who took the food was finally figured out.",
          clues: ["puzzle", "finally figured out"],
          question: "What is a 'mystery'?",
          answer: "something puzzling that needs to be figured out"
        }
      ],
      sequence: [
        { basic: "First, kids...", expanded: "First, kids lost..." },
        { basic: "Next, the teacher...", expanded: "Next, the teacher looked..." },
        { basic: "Then, a squirrel...", expanded: "Then, a squirrel was..." },
        { basic: "Finally, the teacher...", expanded: "Finally, the teacher fixed..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "Who was taking the lunch food?",
          hint: "Look for what the teacher found.",
          answer: "A squirrel"
        },
        {
          type: "literal",
          question: "What did the teacher do to fix the problem?",
          hint: "Find what the teacher did after finding the squirrel.",
          answer: "Fixed the window"
        },
        {
          type: "inferential",
          question: "Why do you think the kids were worried before?",
          hint: "Think about how they felt when food was missing.",
          answer: "They didn't know what was happening / They were confused"
        },
        {
          type: "inferential",
          question: "What does this story teach about solving problems?",
          hint: "Think about what the teacher did to find the answer.",
          answer: "You need to look for clues and investigate"
        }
      ]
    },
    simple: {
      text: `Students at Jefferson Elementary were having a strange problem with their lunch boxes. Every day, different students reported that items from their lunches had disappeared. Emma lost her homemade cookies, Jake couldn't find his apple, and Sarah's sandwich was missing a bite.

Ms. Rodriguez, the third-grade teacher, decided to investigate what was happening. She asked students detailed questions about when they noticed their food was gone. She also spent extra time watching the classroom during lunch periods to look for suspicious activity.

One morning, Ms. Rodriguez arrived at school very early and quietly observed the classroom from the hallway. That's when she witnessed something unexpected - a clever gray squirrel had found a way into the room through a loose window screen and was stealing food from the lunch boxes.

After repairing the damaged screen, Ms. Rodriguez explained the situation to her relieved students. Everyone laughed about their unusual lunch thief, and Jake even suggested they leave some nuts outside for their furry visitor.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "A teacher solved the mystery of missing lunch food by discovering a squirrel was the thief",
          "Elementary school students should always pack healthy lunches with proper containers",
          "School buildings require regular maintenance to prevent wildlife from entering classrooms"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "investigate",
          sentence: "Ms. Rodriguez, the third-grade teacher, decided to investigate what was happening.",
          context: "Ms. Rodriguez wanted to find out the truth about the missing food by looking for facts and evidence.",
          clues: ["find out the truth", "looking for facts and evidence"],
          question: "What does 'investigate' mean?",
          answer: "to search for facts and information to solve a problem"
        },
        {
          word: "witnessed",
          sentence: "That's when she witnessed something unexpected - a clever gray squirrel had found a way into the room.",
          context: "Ms. Rodriguez saw with her own eyes what was really happening in the classroom.",
          clues: ["saw with her own eyes", "what was really happening"],
          question: "What does 'witnessed' mean?",
          answer: "saw something happen with your own eyes"
        }
      ],
      sequence: [
        { basic: "First, students...", expanded: "First, students noticed that..." },
        { basic: "Next, Ms. Rodriguez...", expanded: "Next, Ms. Rodriguez decided to..." },
        { basic: "Then, she...", expanded: "Then, she discovered that..." },
        { basic: "Finally, the mystery...", expanded: "Finally, the mystery was solved when..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What were students reporting about their lunches?",
          hint: "Look at the first paragraph for what was happening to the food.",
          answer: "Items from their lunches were disappearing/missing"
        },
        {
          type: "literal",
          question: "How did Ms. Rodriguez discover the real culprit?",
          hint: "Find what Ms. Rodriguez did to catch the lunch thief.",
          answer: "She arrived early and observed the classroom from the hallway"
        },
        {
          type: "literal",
          question: "How was the squirrel getting into the classroom?",
          hint: "Look for how the squirrel gained access to the room.",
          answer: "Through a loose window screen"
        },
        {
          type: "inferential",
          question: "Why do you think the students were suspicious of each other at first?",
          hint: "Consider what happens when people don't know who is taking their things.",
          answer: "When food goes missing without explanation, people naturally suspect others around them"
        },
        {
          type: "inferential",
          question: "What does Ms. Rodriguez's approach tell us about good problem-solving?",
          hint: "Think about the steps she took to solve the mystery.",
          answer: "Good problem-solving requires observation, patience, and systematic investigation rather than making assumptions"
        }
      ]
    },
    middle: {
      text: `Students at Lincoln Middle School began reporting an unusual phenomenon - items from their packed lunches were mysteriously vanishing. Emma's homemade cookies disappeared, Jake's fresh apple went missing, and by Thursday, five different students had experienced similar losses. The situation was creating suspicion and frustration among classmates.

Ms. Rodriguez, the homeroom teacher, decided to conduct a thorough investigation of these peculiar incidents. She systematically interviewed students about their missing items and established a schedule for monitoring the classroom throughout the day. Determined to resolve the mystery, she arrived at school exceptionally early Friday morning and concealed herself in the hallway to observe.

During her careful surveillance, Ms. Rodriguez identified the actual culprit: an ingenious gray squirrel that had discovered access to the classroom through a damaged window screen. The resourceful creature was systematically opening lunch containers and transporting the most appealing snacks to its outdoor nest.

After repairing the compromised screen, Ms. Rodriguez explained the circumstances to her greatly relieved students. The revelation transformed their previous anxiety into amusement, and Jake even proposed providing nuts for their unexpected classroom visitor. The lunch mystery had been successfully resolved.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "A systematic investigation revealed that a clever squirrel was responsible for stealing lunch items from the classroom",
          "School maintenance problems frequently create disruptions that interfere with educational activities",
          "Student suspicions about missing belongings often damage classroom relationships and trust"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "surveillance",
          sentence: "During her careful surveillance, Ms. Rodriguez identified the actual culprit.",
          context: "Ms. Rodriguez was secretly watching and observing the classroom to gather information about what was happening.",
          clues: ["secretly watching", "observing", "gather information"],
          question: "What does 'surveillance' mean?",
          answer: "careful watching or observing, often done secretly"
        },
        {
          word: "phenomenon",
          sentence: "Students at Lincoln Middle School began reporting an unusual phenomenon - items from their packed lunches were mysteriously vanishing.",
          context: "Something strange and hard to explain was happening repeatedly at the school with students' lunches.",
          clues: ["strange", "hard to explain", "happening repeatedly"],
          question: "What does 'phenomenon' mean?",
          answer: "an unusual or remarkable event that is difficult to explain"
        }
      ],
      sequence: [
        { basic: "Initially, students...", expanded: "Initially, students experienced the problem of..." },
        { basic: "To address this, Ms. Rodriguez...", expanded: "To address this, Ms. Rodriguez conducted..." },
        { basic: "Through observation, she...", expanded: "Through careful observation, she discovered..." },
        { basic: "Resolution occurred when...", expanded: "Resolution occurred when Ms. Rodriguez..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "How many students had experienced lunch losses by Thursday?",
          hint: "Look for the specific number mentioned in the first paragraph.",
          answer: "Five different students"
        },
        {
          type: "literal",
          question: "What systematic steps did Ms. Rodriguez take in her investigation?",
          hint: "Find the sentence that describes her methodical approach.",
          answer: "She systematically interviewed students and established a schedule for monitoring the classroom"
        },
        {
          type: "literal",
          question: "How did the squirrel access the classroom?",
          hint: "Look for the specific entry method the squirrel discovered.",
          answer: "Through a damaged window screen"
        },
        {
          type: "inferential",
          question: "Why do you think the incident was creating 'suspicion and frustration among classmates'?",
          hint: "Consider the psychological impact of unexplained losses in a group setting.",
          answer: "When belongings disappear without explanation, people naturally suspect others in their group, creating distrust and tension"
        },
        {
          type: "inferential",
          question: "What does Ms. Rodriguez's investigative approach demonstrate about effective leadership?",
          hint: "Think about how she handled the situation and what leadership qualities this shows.",
          answer: "Effective leaders investigate problems thoroughly, remain calm under pressure, and solve problems systematically rather than making assumptions"
        }
      ]
    },
    complex: {
      text: `Students at Lincoln Middle School encountered an escalating phenomenon wherein components of their meticulously prepared lunches were inexplicably disappearing. Emma's artisanal cookies vanished without trace, Jake's organic apple mysteriously disappeared, and by week's end, five students had reported analogous losses. This unprecedented situation was generating mounting suspicion and interpersonal tension throughout the academic community.

Ms. Rodriguez, the supervising educator, resolved to conduct a comprehensive investigation into these enigmatic occurrences. She implemented systematic student interviews regarding their missing provisions and instituted rigorous classroom surveillance protocols throughout various periods. Committed to resolving this perplexing mystery, she arrived at the educational facility extraordinarily early Friday morning and established a concealed observation position in the corridor.

During her covert monitoring operation, Ms. Rodriguez identified the authentic perpetrator: an exceptionally resourceful gray squirrel that had ingeniously exploited a compromised window screening mechanism to gain unauthorized classroom access. This remarkable creature was methodically manipulating lunch containers with extraordinary dexterity, selectively appropriating the most nutritionally appealing items for transportation to its external habitat.

Following the restoration of proper window screening integrity, Ms. Rodriguez elucidated the circumstances to her profoundly relieved students. This revelation transformed their preceding anxiety into collective amusement, with Jake proposing the establishment of supplemental nut provisions for their unanticipated academic associate. The alimentary mystery had achieved definitive resolution.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "A methodical investigative approach successfully identified an ingenious squirrel as the perpetrator of systematic lunch theft",
          "Institutional infrastructure maintenance deficiencies frequently precipitate disruptive educational complications",
          "Interpersonal suspicions within academic communities often generate unnecessary social fragmentation and mistrust"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "perpetrator",
          sentence: "Ms. Rodriguez identified the authentic perpetrator: an exceptionally resourceful gray squirrel.",
          context: "Ms. Rodriguez found the real individual who was responsible for committing the crime of taking the lunches.",
          clues: ["real individual", "responsible for committing", "the crime"],
          question: "What does 'perpetrator' mean?",
          answer: "a person or thing that carries out a harmful or illegal act"
        },
        {
          word: "elucidated",
          sentence: "Ms. Rodriguez elucidated the circumstances to her profoundly relieved students.",
          context: "Ms. Rodriguez made the situation clear and easy to understand by explaining all the details to her students.",
          clues: ["made clear", "easy to understand", "explaining all details"],
          question: "What does 'elucidated' mean?",
          answer: "explained something clearly and in detail"
        }
      ],
      sequence: [
        { basic: "Initially, the community...", expanded: "Initially, the academic community confronted..." },
        { basic: "Through investigation, Ms. Rodriguez...", expanded: "Through systematic investigation, Ms. Rodriguez implemented..." },
        { basic: "Surveillance revealed...", expanded: "Comprehensive surveillance ultimately revealed..." },
        { basic: "Resolution was achieved...", expanded: "Resolution was achieved when Ms. Rodriguez..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What specific surveillance protocols did Ms. Rodriguez implement?",
          hint: "Look for the formal term describing her systematic monitoring approach.",
          answer: "Rigorous classroom surveillance protocols throughout various periods"
        },
        {
          type: "literal",
          question: "How did Ms. Rodriguez describe the circumstances to her students after solving the mystery?",
          hint: "Find the technical term used for how she explained the situation.",
          answer: "Ms. Rodriguez elucidated the circumstances to her students"
        },
        {
          type: "literal",
          question: "What was the squirrel's method for accessing the lunch containers?",
          hint: "Look for the description of how the squirrel manipulated the containers.",
          answer: "Methodically manipulating lunch containers with extraordinary dexterity"
        },
        {
          type: "inferential",
          question: "Analyze the escalation from individual incidents to 'mounting suspicion and interpersonal tension throughout the academic community.'",
          hint: "Consider the sociological implications of unexplained losses in institutional settings.",
          answer: "Unexplained losses in closed communities create systemic distrust as members suspect each other, leading to social fragmentation and institutional dysfunction"
        },
        {
          type: "inferential",
          question: "How does Ms. Rodriguez's methodological approach exemplify evidence-based problem-solving in institutional contexts?",
          hint: "Think about the professional framework she applied to address this challenge.",
          answer: "She employed systematic data collection, controlled observation, hypothesis testing, and evidence-based conclusions - demonstrating scientific methodology applied to administrative challenges"
        }
      ]
    }
  },
  "science_fair": {
    title: "The Volcano Project",
    "very-simple": {
      text: `Carlos wanted to make a volcano. Carlos got supplies at the store. Carlos built the volcano with clay. The volcano bubbled and looked like lava. Carlos was excited.`,
      mainIdea: {
        question: "What did Carlos make?",
        choices: [
          "Carlos made a volcano",
          "Carlos went to the store",
          "Carlos was excited"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "supplies",
          sentence: "Carlos got supplies at the store.",
          context: "Carlos bought things he needed to make the volcano.",
          clues: ["bought things", "needed", "make the volcano"],
          question: "What are 'supplies'?",
          answer: "things you need to make something"
        },
        {
          word: "volcano",
          sentence: "Carlos wanted to make a volcano.",
          context: "Carlos wanted to build something that looks like a mountain that shoots out lava.",
          clues: ["looks like a mountain", "shoots out lava"],
          question: "What is a 'volcano'?",
          answer: "a mountain that can shoot out hot lava"
        }
      ],
      sequence: [
        { basic: "First, Carlos...", expanded: "First, Carlos wanted to..." },
        { basic: "Next, Carlos...", expanded: "Next, Carlos got..." },
        { basic: "Then, Carlos...", expanded: "Then, Carlos built..." },
        { basic: "Finally, Carlos...", expanded: "Finally, Carlos was..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What did Carlos use to build his volcano?",
          hint: "Look for what Carlos used to make the volcano shape.",
          answer: "Clay"
        },
        {
          type: "literal",
          question: "What happened when the volcano erupted?",
          hint: "Find what the mixture did when it reacted.",
          answer: "It bubbled and looked like lava"
        },
        {
          type: "inferential",
          question: "Why do you think Carlos was excited?",
          hint: "Think about what Carlos wanted to do and what happened.",
          answer: "Because his volcano worked / He made something cool"
        },
        {
          type: "inferential",
          question: "What does this story show about trying new things?",
          hint: "Think about what happened when Carlos tried to make a volcano.",
          answer: "When you try new things, you can succeed and feel proud"
        }
      ]
    },
    simple: {
      text: `Carlos had always been fascinated by volcanoes and decided to create one for the upcoming science fair. He wanted to show his classmates how a real volcano works by making a model that would actually erupt.

Carlos researched volcano projects on the internet with his mom's help. They discovered that mixing baking soda with vinegar creates a bubbling reaction that looks like lava. They made a shopping list and bought all the necessary materials at the store.

At home, Carlos carefully constructed his volcano using modeling clay shaped around a plastic bottle. He mixed red food coloring with the vinegar to make it look more realistic. When he added the colored vinegar to the baking soda inside the bottle, the mixture bubbled up dramatically.

Carlos was thrilled with his successful experiment. His volcano looked authentic and created an impressive eruption that would definitely capture everyone's attention at the science fair.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Carlos created a successful volcano experiment for the science fair using research and careful planning",
          "Internet research provides students with all the information they need for school projects",
          "Science fair projects should always involve dramatic demonstrations that impress the audience"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "experiment",
          sentence: "Carlos was thrilled with his successful experiment.",
          context: "Carlos was happy that his scientific test to see if mixing the chemicals would work turned out well.",
          clues: ["scientific test", "mixing chemicals", "turned out well"],
          question: "What is an 'experiment'?",
          answer: "a scientific test to see if something works"
        },
        {
          word: "reaction",
          sentence: "They discovered that mixing baking soda with vinegar creates a bubbling reaction that looks like lava.",
          context: "When Carlos mixed the two substances together, something new happened - they bubbled up.",
          clues: ["mixed substances together", "something new happened", "bubbled up"],
          question: "What is a 'reaction'?",
          answer: "what happens when two substances are mixed together"
        }
      ],
      sequence: [
        { basic: "First, Carlos...", expanded: "First, Carlos wanted to..." },
        { basic: "Next, Carlos...", expanded: "Next, Carlos researched and..." },
        { basic: "Then, Carlos...", expanded: "Then, Carlos built and..." },
        { basic: "Finally, Carlos...", expanded: "Finally, Carlos tested and..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What two substances did Carlos discover would create the eruption effect?",
          hint: "Look for the chemical combination mentioned in the research section.",
          answer: "Baking soda and vinegar"
        },
        {
          type: "literal",
          question: "What did Carlos add to make his volcano look more realistic?",
          hint: "Find what Carlos mixed with the vinegar for appearance.",
          answer: "Red food coloring"
        },
        {
          type: "literal",
          question: "How did Carlos construct the volcano structure?",
          hint: "Look for the specific method used to build the volcano shape.",
          answer: "Using modeling clay shaped around a plastic bottle"
        },
        {
          type: "inferential",
          question: "Why do you think Carlos researched volcano projects on the internet first?",
          hint: "Consider what research would provide before starting the project.",
          answer: "To learn the best methods and ensure his volcano would work properly"
        },
        {
          type: "inferential",
          question: "What does Carlos's approach demonstrate about effective project planning?",
          hint: "Think about the sequence of steps Carlos followed.",
          answer: "Effective planning involves research, preparation, testing, and careful execution"
        }
      ]
    },
    middle: {
      text: `Carlos had maintained a lifelong fascination with geological formations and decided to construct an erupting volcano model for the regional science fair. His objective was to demonstrate the fundamental scientific principles behind volcanic activity while creating an engaging educational presentation.

Through extensive internet research conducted with his mother's guidance, Carlos investigated various methodological approaches to volcano experimentation. They determined that combining sodium bicarbonate with acetic acid would generate the optimal chemical reaction, necessitating the purchase of specialized materials including sculptural clay, chromatic additives, and laboratory equipment.

Carlos meticulously engineered his volcanic structure by skillfully molding clay around a central container to achieve geological authenticity. He formulated his hypothesis about the expected results and carefully measured the reactant proportions to ensure a dramatic eruption effect.

During his demonstration rehearsal, Carlos systematically introduced the acidic solution into the reaction chamber while documenting the process. The subsequent eruption exceeded his theoretical predictions, creating a spectacular display that would effectively communicate volcanic science to his audience.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Carlos applied scientific methodology to create an educational volcano demonstration that exceeded his expectations",
          "Regional science competitions require students to use expensive laboratory equipment for successful projects",
          "Geological formations can only be understood through hands-on experimentation and practical applications"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "hypothesis",
          sentence: "He formulated his hypothesis about the expected results and carefully measured the reactant proportions to ensure a dramatic eruption effect.",
          context: "Carlos made an educated guess about what would happen in his experiment before he actually tested it.",
          clues: ["educated guess", "what would happen", "before he tested it"],
          question: "What is a 'hypothesis'?",
          answer: "an educated guess about what will happen in an experiment"
        },
        {
          word: "methodological",
          sentence: "Through extensive internet research conducted with his mother's guidance, Carlos investigated various methodological approaches to volcano experimentation.",
          context: "Carlos looked at different organized ways and systems that scientists use to conduct volcano experiments properly.",
          clues: ["organized ways", "systems", "conduct experiments properly"],
          question: "What does 'methodological' mean?",
          answer: "relating to organized ways or systems of doing something"
        }
      ],
      sequence: [
        { basic: "Initially, Carlos...", expanded: "Initially, Carlos decided to..." },
        { basic: "During research, Carlos...", expanded: "During research, Carlos discovered..." },
        { basic: "While constructing, Carlos...", expanded: "While constructing, Carlos carefully..." },
        { basic: "During demonstration, Carlos...", expanded: "During demonstration, Carlos successfully..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What specific materials did Carlos determine he needed for the optimal chemical reaction?",
          hint: "Look for the technical terms for the chemical compounds mentioned.",
          answer: "Sodium bicarbonate and acetic acid"
        },
        {
          type: "literal",
          question: "What did Carlos formulate before conducting his experiment?",
          hint: "Find the scientific term for his educated prediction about results.",
          answer: "Comprehensive hypotheses about the anticipated outcomes"
        },
        {
          type: "literal",
          question: "How did the actual eruption compare to Carlos's theoretical predictions?",
          hint: "Look for how the results matched his expectations.",
          answer: "The eruption exceeded his theoretical projections"
        },
        {
          type: "inferential",
          question: "How does Carlos's approach demonstrate scientific methodology in practice?",
          hint: "Consider the systematic steps Carlos followed in his project.",
          answer: "Carlos followed the scientific method: research, hypothesis formation, careful measurement, controlled testing, and documentation of results"
        },
        {
          type: "inferential",
          question: "What does the story suggest about the relationship between preparation and success?",
          hint: "Think about how Carlos's careful planning affected his outcome.",
          answer: "Thorough preparation and systematic approach lead to results that exceed expectations"
        }
      ]
    },
    complex: {
      text: `Carlos had cultivated a profound fascination with geological phenomena and resolved to construct an authentic volcanic eruption simulation for the institution's prestigious annual science exposition. His objective was to demonstrate the fundamental chemical principles underlying volcanic activity while creating a compelling educational presentation that would illuminate complex scientific processes.

Through comprehensive internet research conducted with maternal collaboration, Carlos investigated diverse methodological approaches to volcanic experimentation. They ascertained that the interaction between sodium bicarbonate and acetic acid would produce the optimal effervescent response, necessitating the procurement of specialized materials including sculptural clay, chromatic enhancement agents, and precise measurement apparatus.

Carlos meticulously engineered his volcanic structure through skillful manipulation of clay around a central receptacle to achieve maximum geological authenticity. He formulated comprehensive hypotheses regarding the anticipated outcomes and calibrated the reactant proportions with scientific precision to ensure optimal demonstration effectiveness.

During his preliminary assessment, Carlos systematically introduced the acidic solution into the reaction chamber while maintaining detailed documentation of procedural variables. The subsequent eruption surpassed his theoretical projections, generating substantial appreciation from observers and exemplifying the successful integration of scientific methodology with compelling visual presentation.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Carlos executed a scientifically rigorous volcanic demonstration that successfully integrated theoretical knowledge with practical application",
          "Prestigious institutional science expositions require participants to demonstrate mastery of complex chemical processes and laboratory techniques",
          "Geological phenomena can only be comprehended through extensive theoretical study combined with hands-on experimental validation"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "ascertained",
          sentence: "They ascertained that the interaction between sodium bicarbonate and acetic acid would produce the optimal effervescent response.",
          context: "Carlos and his mother found out for certain, through their research, which chemical combination would work best for their project.",
          clues: ["found out for certain", "through research", "which would work best"],
          question: "What does 'ascertained' mean?",
          answer: "found out or determined something for certain"
        },
        {
          word: "calibrated",
          sentence: "He formulated comprehensive hypotheses regarding the anticipated outcomes and calibrated the reactant proportions with scientific precision.",
          context: "Carlos carefully adjusted and fine-tuned the exact amounts of chemicals to get precisely the right results for his experiment.",
          clues: ["carefully adjusted", "fine-tuned", "exact amounts", "precisely right results"],
          question: "What does 'calibrated' mean?",
          answer: "carefully adjusted or fine-tuned to achieve precise results"
        }
      ],
      sequence: [
        { basic: "Initially, Carlos...", expanded: "Initially, Carlos resolved to construct..." },
        { basic: "Through research, Carlos...", expanded: "Through comprehensive research, Carlos investigated..." },
        { basic: "During construction, Carlos...", expanded: "During construction, Carlos meticulously engineered..." },
        { basic: "At presentation, Carlos...", expanded: "At presentation, Carlos successfully demonstrated..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What did Carlos ascertain about the interaction between the two chemical compounds?",
          hint: "Look for what Carlos and his mother determined about the chemical reaction.",
          answer: "That the interaction between sodium bicarbonate and acetic acid would produce the optimal effervescent response"
        },
        {
          type: "literal",
          question: "How did Carlos calibrate the reactant proportions?",
          hint: "Find the description of how Carlos adjusted the chemical measurements.",
          answer: "Carlos calibrated the reactant proportions with scientific precision"
        },
        {
          type: "literal",
          question: "What was the outcome when Carlos compared his results to his theoretical projections?",
          hint: "Look for how the actual eruption compared to Carlos's expectations.",
          answer: "The subsequent eruption surpassed his theoretical projections"
        },
        {
          type: "inferential",
          question: "Analyze how Carlos's project exemplifies the integration of theoretical knowledge with practical application.",
          hint: "Consider how Carlos combined scientific concepts with hands-on work.",
          answer: "Carlos applied theoretical chemical principles through systematic experimentation, demonstrating how scientific understanding becomes meaningful through practical implementation"
        },
        {
          type: "inferential",
          question: "Evaluate the significance of Carlos's documentation process in scientific methodology.",
          hint: "Think about why Carlos maintained detailed records of his procedures.",
          answer: "Documentation enables reproducibility, validates findings, and exemplifies rigorous scientific practice essential for credible research"
        }
      ]
    }
  },
  "new_student": {
    title: "The New Student",
    "very-simple": {
      text: `Sophia was new at school. Sophia sat alone at lunch. Jake saw Sophia was sad. Jake sat with Sophia. Now Sophia has a friend.`,
      mainIdea: {
        question: "What happened at school?",
        choices: [
          "Jake helped Sophia make a friend",
          "Sophia ate lunch alone",
          "Jake was hungry"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "alone",
          sentence: "Sophia sat alone at lunch.",
          context: "Sophia had no friends to sit with at lunch time.",
          clues: ["no friends", "sit with", "lunch time"],
          question: "What does 'alone' mean?",
          answer: "by yourself with no one else"
        },
        {
          word: "friend",
          sentence: "Now Sophia has a friend.",
          context: "Sophia now has someone who likes her and wants to spend time with her.",
          clues: ["someone who likes her", "spend time with her"],
          question: "What is a 'friend'?",
          answer: "someone who likes you and wants to spend time with you"
        }
      ],
      sequence: [
        { basic: "First, Sophia...", expanded: "First, Sophia was..." },
        { basic: "Next, Jake...", expanded: "Next, Jake saw..." },
        { basic: "Then, Jake...", expanded: "Then, Jake sat..." },
        { basic: "Finally, Sophia...", expanded: "Finally, Sophia has..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "Where was Sophia eating lunch?",
          hint: "Look for where Sophia sat during lunch time.",
          answer: "Alone at lunch"
        },
        {
          type: "literal",
          question: "What did Jake do when he saw Sophia was sad?",
          hint: "Find what Jake did to help Sophia.",
          answer: "Jake sat with Sophia"
        },
        {
          type: "inferential",
          question: "How do you think Sophia felt when Jake sat with her?",
          hint: "Think about how someone feels when they make a friend.",
          answer: "Happy, glad, less lonely"
        },
        {
          type: "inferential",
          question: "What does this story teach about being kind?",
          hint: "Think about what happened when Jake was kind to Sophia.",
          answer: "Being kind to others helps them feel better and makes friends"
        }
      ]
    },
    simple: {
      text: `A new girl named Sophia transferred to Washington Elementary in the middle of the school year. She felt nervous and scared because she didn't know anyone at her new school. During lunch, Sophia sat by herself at an empty table while watching other students laugh and talk with their friends.

Jake noticed the new student sitting alone and felt sorry for her. He remembered how difficult it was when his family moved and he started at a different school last year. Jake made a decision to approach Sophia and try to make her feel welcome.

Jake walked over to Sophia's table and politely asked if he could join her for lunch. Sophia's face brightened up and she gratefully said yes. Jake introduced her to several of his friends, and they all enjoyed talking about their favorite subjects, hobbies, and teachers.

By the end of her first week, Sophia had made multiple new friends and felt much more comfortable at her new school. She thanked Jake for his kindness and told him how much his friendship meant to her during this challenging time.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Jake helped a new student feel welcome and make friends by showing kindness and including her in his group",
          "Starting at a new school in the middle of the year is always difficult for elementary students",
          "School cafeterias are the best places for students to meet new people and develop friendships"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "transferred",
          sentence: "A new girl named Sophia transferred to Washington Elementary in the middle of the school year.",
          context: "Sophia had to leave her old school and start going to a different school instead.",
          clues: ["leave her old school", "start going to different school"],
          question: "What does 'transferred' mean?",
          answer: "moved from one school to another school"
        },
        {
          word: "approach",
          sentence: "Jake made a decision to approach Sophia and try to make her feel welcome.",
          context: "Jake decided to walk over and go near Sophia so he could talk to her and be friendly.",
          clues: ["walk over", "go near", "so he could talk to her"],
          question: "What does 'approach' mean?",
          answer: "to go near someone or walk over to them"
        }
      ],
      sequence: [
        { basic: "First, Sophia...", expanded: "First, Sophia started..." },
        { basic: "Next, Jake...", expanded: "Next, Jake noticed and..." },
        { basic: "Then, Jake...", expanded: "Then, Jake approached and..." },
        { basic: "Finally, Sophia...", expanded: "Finally, Sophia made friends and..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "When did Sophia transfer to Washington Elementary?",
          hint: "Look for the timing mentioned in the first sentence.",
          answer: "In the middle of the school year"
        },
        {
          type: "literal",
          question: "What did Jake do when he approached Sophia's table?",
          hint: "Find what Jake asked Sophia when he walked over to her.",
          answer: "He politely asked if he could join her for lunch"
        },
        {
          type: "literal",
          question: "How long did it take for Sophia to make multiple friends?",
          hint: "Look for the timeframe mentioned for Sophia's social success.",
          answer: "By the end of her first week"
        },
        {
          type: "inferential",
          question: "Why do you think Jake understood how Sophia was feeling?",
          hint: "Look for information about Jake's own experience with changing schools.",
          answer: "Because Jake's family had moved and he started at a different school last year, so he knew how it felt"
        },
        {
          type: "inferential",
          question: "What does this story suggest about the impact of small acts of kindness?",
          hint: "Think about how Jake's simple action affected Sophia's entire experience.",
          answer: "Small acts of kindness can have a big impact and completely change someone's experience for the better"
        }
      ]
    },
    middle: {
      text: `Sophia enrolled at Roosevelt Middle School in January, arriving midway through the academic year. The transition proved challenging as she possessed no established social connections and felt intimidated by the unfamiliar environment. During her first lunch period, she sat isolated at an empty table, observing other students interacting comfortably within their established friendship groups.

Jake observed the new student sitting alone and immediately empathized with her difficult situation. Having experienced a similar transition when his family relocated the previous year, he understood the challenges of adjusting to an unfamiliar school environment. Jake resolved to reach out and offer genuine friendship to help ease her adjustment.

Approaching Sophia's table with consideration, Jake courteously requested permission to join her for lunch. Sophia's expression immediately improved, and she welcomed his company with obvious relief. Jake facilitated introductions with his established friend group, who demonstrated warmth and acceptance toward their new classmate.

Within one week, Sophia had successfully integrated into the school's social environment and developed several meaningful friendships. She expressed heartfelt gratitude to Jake for his compassionate gesture and credited him with transforming her initially overwhelming experience into a positive transition.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Jake's empathetic outreach helped a new student successfully integrate into the school community through genuine friendship",
          "Middle school transitions require comprehensive administrative support programs to ensure student success",
          "Academic institutions should implement structured social integration programs for mid-year transfer students"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "empathized",
          sentence: "Jake observed the new student sitting alone and immediately empathized with her difficult situation.",
          context: "Jake understood exactly how Sophia felt because he had been in the same difficult situation himself before.",
          clues: ["understood exactly how she felt", "same difficult situation", "himself before"],
          question: "What does 'empathized' mean?",
          answer: "understood and shared someone else's feelings from personal experience"
        },
        {
          word: "integrated",
          sentence: "Within one week, Sophia had successfully integrated into the school's social environment and developed several meaningful friendships.",
          context: "Sophia had become a natural part of the school's social groups and fit in well with other students.",
          clues: ["became natural part", "social groups", "fit in well"],
          question: "What does 'integrated' mean?",
          answer: "became part of a group and fit in successfully"
        }
      ],
      sequence: [
        { basic: "Initially, Sophia...", expanded: "Initially, Sophia transferred and..." },
        { basic: "Jake noticed and...", expanded: "Jake noticed and empathized..." },
        { basic: "By approaching, Jake...", expanded: "By approaching, Jake facilitated..." },
        { basic: "Ultimately, Sophia...", expanded: "Ultimately, Sophia successfully integrated..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "When did Sophia enroll at Roosevelt Middle School?",
          hint: "Look for the specific timing mentioned in the first sentence.",
          answer: "In January, midway through the academic year"
        },
        {
          type: "literal",
          question: "What specific strategy did Jake use to help Sophia adjust?",
          hint: "Find what Jake did systematically to help Sophia make friends.",
          answer: "Jake facilitated introductions with his established friend group"
        },
        {
          type: "literal",
          question: "How quickly did Sophia integrate into the school's social environment?",
          hint: "Look for the timeframe mentioned for Sophia's successful adjustment.",
          answer: "Within one week"
        },
        {
          type: "inferential",
          question: "Why was Jake's personal experience with relocation important to this story?",
          hint: "Consider how Jake's past experience influenced his actions toward Sophia.",
          answer: "Jake's similar experience gave him empathy and understanding of what Sophia was going through, motivating him to help her"
        },
        {
          type: "inferential",
          question: "What does this narrative suggest about the role of empathy in leadership?",
          hint: "Think about how Jake's ability to understand Sophia's feelings affected his leadership approach.",
          answer: "Empathy enables effective leadership by helping leaders understand others' needs and take appropriate action to support them"
        }
      ]
    },
    complex: {
      text: `Sophia commenced her enrollment at Jefferson Middle School during the midpoint of the academic semester, necessitating a formidable adjustment to an entirely unfamiliar institutional environment. The transition proved particularly arduous as she possessed no established social connections and felt overwhelmed by the intricate dynamics of pre-existing peer relationships. During her inaugural cafeteria experience, she maintained isolation at an unoccupied table, observing the sophisticated social interactions occurring within well-established cliques.

Jake discerned the newly arrived student's solitary predicament and experienced profound empathy regarding her circumstances. Having endured a comparable transitional challenge during the preceding academic year when his family's relocation necessitated educational institution transfer, he possessed intimate comprehension of the psychological complexities inherent in scholastic environmental adaptation. Jake formulated a deliberate resolution to extend compassionate friendship and facilitate social inclusion.

Approaching Sophia's location with respectful consideration, Jake courteously solicited permission to share her dining space. Sophia's countenance demonstrated marked improvement, and she expressed genuine appreciation for his considerate gesture. Jake orchestrated systematic introductions with his established peer network, who demonstrated remarkable receptivity and authentic warmth toward facilitating her social integration.

Within a single week, Sophia had achieved successful assimilation into the institution's complex social infrastructure and cultivated multiple authentic interpersonal relationships. She conveyed profound gratitude to Jake for his compassionate intervention and attributed her positive transitional outcome to his empathetic leadership in fostering inclusive community dynamics.`,
      mainIdea: {
        question: "What is the main idea of this story?",
        choices: [
          "Jake's deliberate compassionate intervention facilitated a new student's successful social assimilation through empathetic leadership and inclusive community building",
          "Educational institutions require comprehensive systematic approaches to address the complex psychological challenges faced by transfer students",
          "Adolescent social dynamics within academic environments typically create exclusionary barriers that prevent meaningful peer integration"
        ],
        correct: 0
      },
      contextClues: [
        {
          word: "compassionate",
          sentence: "Jake formulated a deliberate resolution to extend compassionate friendship and facilitate social inclusion.",
          context: "Jake made a thoughtful decision to show caring, kind friendship that would help Sophia feel included and accepted.",
          clues: ["thoughtful decision", "caring, kind friendship", "help feel included and accepted"],
          question: "What does 'compassionate' mean?",
          answer: "showing caring concern and kindness toward someone who is suffering"
        },
        {
          word: "assimilation",
          sentence: "Within a single week, Sophia had achieved successful assimilation into the institution's complex social infrastructure.",
          context: "Sophia had completely blended in and become a natural part of the school's complicated social system and relationships.",
          clues: ["completely blended in", "natural part", "complicated social system"],
          question: "What does 'assimilation' mean?",
          answer: "the process of becoming fully absorbed and integrated into a group or system"
        }
      ],
      sequence: [
        { basic: "Initially, Sophia...", expanded: "Initially, Sophia commenced enrollment and..." },
        { basic: "Jake discerned and...", expanded: "Jake discerned the situation and..." },
        { basic: "Through intervention, Jake...", expanded: "Through deliberate intervention, Jake orchestrated..." },
        { basic: "Consequently, Sophia...", expanded: "Consequently, Sophia achieved successful..." }
      ],
      comprehension: [
        {
          type: "literal",
          question: "What specific term describes how Jake approached Sophia's dining location?",
          hint: "Look for the formal descriptor of Jake's manner when he came to Sophia's table.",
          answer: "With respectful consideration"
        },
        {
          type: "literal",
          question: "What did Jake orchestrate to facilitate Sophia's social integration?",
          hint: "Find the technical term for how Jake managed introductions.",
          answer: "Systematic introductions with his established peer network"
        },
        {
          type: "literal",
          question: "What was the nature of Sophia's final transitional outcome?",
          hint: "Look for the ultimate result of Sophia's experience.",
          answer: "Positive transitional outcome"
        },
        {
          type: "inferential",
          question: "Analyze the psychological mechanisms underlying Jake's empathetic intervention approach.",
          hint: "Consider the deeper psychological principles behind Jake's decision-making process.",
          answer: "Jake's personal experience with similar challenges created cognitive empathy, enabling him to recognize distress signals and implement targeted social support mechanisms"
        },
        {
          type: "inferential",
          question: "Evaluate how this narrative exemplifies the role of social capital in institutional environments.",
          hint: "Think about how established relationships and social networks function in academic settings.",
          answer: "The narrative demonstrates how individuals with established social capital can leverage their networks to facilitate newcomer integration, highlighting the importance of inclusive community dynamics in institutional success"
        }
      ]
    }
  }
};

let currentLevel = 'very-simple';
let selectedObjectives = [];
let currentStory = 'garden';
let currentActivity = 'main-idea';

// Picture storage key
const PICTURES_STORAGE_KEY = 'reading_comp_pictures';

// Initialize the app
document.addEventListener('DOMContentLoaded', initializeApp);

function initializeApp() {
  setupEventListeners();
  updateSetupSummary();
}

function setupEventListeners() {
  // Level selector
  document.querySelectorAll('.level-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentLevel = btn.dataset.level;
      updateSetupSummary();
    });
  });

  // Objective selector
  document.querySelectorAll('.objective-card').forEach(card => {
    card.addEventListener('click', () => {
      const checkbox = card.querySelector('input[type="checkbox"]');
      checkbox.checked = !checkbox.checked;
      
      if (checkbox.checked) {
        card.classList.add('selected');
      } else {
        card.classList.remove('selected');
      }
      
      updateSelectedObjectives();
      updateSetupSummary();
    });
  });

  // Start session button
  document.getElementById('startSession').addEventListener('click', startSession);

  // Back to setup button
  document.getElementById('backToSetup').addEventListener('click', backToSetup);

  // Reset activity button
  document.getElementById('resetActivity').addEventListener('click', resetCurrentActivity);

  // Picture functionality
  document.getElementById('addPicture').addEventListener('click', () => {
    document.getElementById('pictureUpload').classList.toggle('show');
  });

  document.getElementById('pictureInput').addEventListener('change', handlePictureUpload);
  document.getElementById('removePicture').addEventListener('click', removePicture);
}

function updateSelectedObjectives() {
  selectedObjectives = [];
  document.querySelectorAll('.objective-card input:checked').forEach(checkbox => {
    selectedObjectives.push(checkbox.closest('.objective-card').dataset.objective);
  });
}

function updateSetupSummary() {
  const summaryEl = document.getElementById('selectionSummary');
  const startBtn = document.getElementById('startSession');
  
  if (selectedObjectives.length === 0) {
    summaryEl.textContent = 'Select a reading level and at least one objective to begin';
    startBtn.disabled = true;
  } else {
    const levelText = currentLevel.replace('-', ' ').charAt(0).toUpperCase() + currentLevel.replace('-', ' ').slice(1);
    const objectiveText = selectedObjectives.length === 1 ? '1 objective' : `${selectedObjectives.length} objectives`;
    summaryEl.innerHTML = `Ready to start: <strong>${levelText} Level</strong> with <strong>${objectiveText} selected</strong>`;
    startBtn.disabled = false;
  }
}

function startSession() {
  document.getElementById('setupPanel').style.display = 'none';
  document.getElementById('mainActivity').style.display = 'block';
  document.getElementById('backToSetup').style.display = 'inline-block';
  document.getElementById('resetActivity').style.display = 'inline-block';
  document.getElementById('addPicture').style.display = 'inline-block';
  document.getElementById('teacherInfo').style.display = 'inline-block';
  
  updateTeacherInfo();
  initializeMainActivity();
}

function backToSetup() {
  document.getElementById('setupPanel').style.display = 'block';
  document.getElementById('mainActivity').style.display = 'none';
  document.getElementById('backToSetup').style.display = 'none';
  document.getElementById('resetActivity').style.display = 'none';
  document.getElementById('addPicture').style.display = 'none';
  document.getElementById('teacherInfo').style.display = 'none';
  document.getElementById('pictureUpload').classList.remove('show');
}

function updateTeacherInfo() {
  const teacherInfo = document.getElementById('teacherInfo');
  const levelText = currentLevel.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
  teacherInfo.textContent = `Level: ${levelText}`;
  teacherInfo.className = `teacher-info ${currentLevel}`;
}

function initializeMainActivity() {
  createStorySelector();
  createActivityToggle();
  loadStory(currentStory);
  setupMainActivityListeners();
}

function createStorySelector() {
  const selector = document.getElementById('storySelector');
  selector.innerHTML = '';
  
  Object.keys(storyData).forEach((storyKey, index) => {
    const btn = document.createElement('button');
    btn.className = `story-btn ${storyKey === currentStory ? 'active' : ''}`;
    btn.dataset.story = storyKey;
    btn.textContent = `Story ${index + 1}`;
    selector.appendChild(btn);
  });
}

function createActivityToggle() {
  const toggle = document.getElementById('activityToggle');
  toggle.innerHTML = '';
  
  const activityMappings = {
    'main-idea': 'üéØ Main Idea',
    'context-clues': 'üîç Context Clues', 
    'sequence': 'üìù Story Sequence',
    'comprehension': 'ü§î Comprehension Questions'
  };
  
  selectedObjectives.forEach((objective, index) => {
    const btn = document.createElement('button');
    btn.className = `toggle-btn ${index === 0 ? 'active' : ''}`;
    btn.dataset.activity = objective;
    btn.textContent = activityMappings[objective];
    toggle.appendChild(btn);
  });
  
  if (selectedObjectives.length > 0) {
    currentActivity = selectedObjectives[0];
  }
}

function loadStory(storyKey) {
  currentStory = storyKey;
  const story = storyData[storyKey][currentLevel];
  
  // Update story header
  document.getElementById('storyTitle').textContent = storyData[storyKey].title;
  
  // Load saved picture if exists
  loadStoryPicture(storyKey);
  
  // Update story text
  const storyText = document.getElementById('storyText');
  storyText.className = `story-text ${currentLevel}`;
  storyText.innerHTML = story.text.split('\n\n').map(p => `<p>${p.trim()}</p>`).join('');
  
  // Update story selector
  document.querySelectorAll('.story-btn').forEach((btn) => {
    btn.classList.toggle('active', btn.dataset.story === storyKey);
  });
  
  // Load activities
  loadMainIdeaActivity(story);
  loadContextCluesActivity(story);
  loadSequenceActivity(story);
  loadComprehensionActivity(story);
  
  // Show current activity
  showActivity(currentActivity);
}

function loadStoryPicture(storyKey) {
  const savedPictures = JSON.parse(localStorage.getItem(PICTURES_STORAGE_KEY) || '{}');
  const pictureData = savedPictures[storyKey];
  const pictureEl = document.getElementById('storyPicture');
  
  if (pictureData) {
    pictureEl.src = pictureData;
    pictureEl.style.display = 'block';
  } else {
    pictureEl.style.display = 'none';
  }
}

function handlePictureUpload(event) {
  const file = event.target.files[0];
  if (file && file.type.startsWith('image/')) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const imageData = e.target.result;
      
      // Save to localStorage
      const savedPictures = JSON.parse(localStorage.getItem(PICTURES_STORAGE_KEY) || '{}');
      savedPictures[currentStory] = imageData;
      localStorage.setItem(PICTURES_STORAGE_KEY, JSON.stringify(savedPictures));
      
      // Display the image
      const pictureEl = document.getElementById('storyPicture');
      pictureEl.src = imageData;
      pictureEl.style.display = 'block';
      
      // Update file name display
      document.getElementById('pictureFileName').textContent = file.name;
    };
    reader.readAsDataURL(file);
  }
}

function removePicture() {
  // Remove from localStorage
  const savedPictures = JSON.parse(localStorage.getItem(PICTURES_STORAGE_KEY) || '{}');
  delete savedPictures[currentStory];
  localStorage.setItem(PICTURES_STORAGE_KEY, JSON.stringify(savedPictures));
  
  // Hide the image
  document.getElementById('storyPicture').style.display = 'none';
  
  // Clear the input and filename
  document.getElementById('pictureInput').value = '';
  document.getElementById('pictureFileName').textContent = '';
}

function loadMainIdeaActivity(story) {
  if (!selectedObjectives.includes('main-idea')) return;
  
  const choicesContainer = document.getElementById('mainIdeaChoices');
  choicesContainer.innerHTML = '';
  
  story.mainIdea.choices.forEach((choice, index) => {
    const choiceEl = document.createElement('div');
    choiceEl.className = 'main-idea-choice';
    choiceEl.dataset.choice = index;
    choiceEl.textContent = choice;
    choiceEl.addEventListener('click', () => selectMainIdeaChoice(index));
    choicesContainer.appendChild(choiceEl);
  });
  
  document.getElementById('mainIdeaFeedback').classList.remove('show');
}

function loadContextCluesActivity(story) {
  if (!selectedObjectives.includes('context-clues')) return;
  
  const container = document.getElementById('contextCluesActivity');
  container.innerHTML = '';
  
  story.contextClues.forEach((item, index) => {
    const itemDiv = document.createElement('div');
    itemDiv.className = 'vocab-word';
    itemDiv.innerHTML = `
      <div class="vocab-word-title">Context Clues: "${item.word}"</div>
      
      <div class="vocab-sentence">
        ${item.sentence.replace(item.word, `<span class="vocab-target">${item.word}</span>`)}
      </div>
      
      <div class="vocab-question" style="margin: 15px 0;">
        ${item.question}
      </div>
      
      <textarea class="vocab-input" id="context_${index}" 
                placeholder="Use the context clues in the sentence to figure out what this word means..."></textarea>
      
      <div style="display: flex; gap: 10px; align-items: center; margin: 10px 0;">
        <button class="warning small" onclick="showContextHelp(${index})">üí° I need help</button>
        <button class="primary" onclick="checkContextAnswer(${index})">‚úì Check My Answer</button>
      </div>
      
      <div class="context-clues-section" id="contextHelp_${index}">
        <h4>üîç Context Clues to Help You:</h4>
        <p>${item.context}</p>
        <p><strong>Key clues:</strong> ${item.clues.map(clue => `<span class="clue-highlight">${clue}</span>`).join(', ')}</p>
      </div>
      
      <div class="feedback" id="contextFeedback_${index}"></div>
    `;
    
    container.appendChild(itemDiv);
  });
}

function loadSequenceActivity(story) {
  if (!selectedObjectives.includes('sequence')) return;
  
  const container = document.getElementById('sequenceSteps');
  container.innerHTML = '';
  
  story.sequence.forEach((starterObj, index) => {
    const stepDiv = document.createElement('div');
    stepDiv.className = 'sequence-step';
    stepDiv.innerHTML = `
      <div class="step-number">${index + 1}</div>
      <div class="step-content">
        <div class="sentence-starter" id="starter_${index}">${starterObj.basic}</div>
        <textarea class="sequence-input" id="sequence_${index}" 
                  placeholder="Complete this part of the story..."></textarea>
        <div class="step-help-section">
          <button class="warning small" onclick="showSequenceHelp(${index})">üí° I need help</button>
        </div>
      </div>
    `;
    container.appendChild(stepDiv);
  });
  
  document.getElementById('sequenceFeedback').classList.remove('show');
}

function loadComprehensionActivity(story) {
  if (!selectedObjectives.includes('comprehension')) return;
  
  const container = document.getElementById('comprehensionQuestions');
  container.innerHTML = '';
  
  story.comprehension.forEach((question, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.className = 'comprehension-question';
    questionDiv.innerHTML = `
      <div class="question-header">
        <span class="question-type ${question.type}">${question.type}</span>
      </div>
      
      <div class="question-text">${question.question}</div>
      
      <textarea class="question-input" id="comprehension_${index}" 
                placeholder="Write your answer here..."></textarea>
      
      <div class="question-help">
        <button class="warning small" onclick="showComprehensionHint(${index})">üí° I need a hint</button>
        <button class="primary small" onclick="checkComprehensionAnswer(${index})">‚úì Check Answer</button>
      </div>
      
      <div class="question-hint" id="comprehensionHint_${index}">
        <strong>Hint:</strong> ${question.hint}
      </div>
      
      <div class="question-feedback" id="comprehensionFeedback_${index}"></div>
    `;
    
    container.appendChild(questionDiv);
  });
}

function setupMainActivityListeners() {
  // Story selector
  document.getElementById('storySelector').addEventListener('click', (e) => {
    if (e.target.classList.contains('story-btn')) {
      loadStory(e.target.dataset.story);
    }
  });

  // Activity toggle
  document.getElementById('activityToggle').addEventListener('click', (e) => {
    if (e.target.classList.contains('toggle-btn')) {
      currentActivity = e.target.dataset.activity;
      document.querySelectorAll('.toggle-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.activity === currentActivity);
      });
      showActivity(currentActivity);
    }
  });

  // Check buttons
  document.getElementById('checkMainIdea')?.addEventListener('click', checkMainIdea);
  document.getElementById('checkSequence')?.addEventListener('click', checkSequence);
  document.getElementById('checkComprehension')?.addEventListener('click', checkComprehension);
}

function showActivity(activityType) {
  document.querySelectorAll('.activity-section').forEach(section => {
    section.classList.remove('active');
  });
  
  const sectionMap = {
    'main-idea': 'mainIdeaSection',
    'context-clues': 'contextCluesSection',
    'sequence': 'sequenceSection',
    'comprehension': 'comprehensionSection'
  };
  
  const targetSection = document.getElementById(sectionMap[activityType]);
  if (targetSection) {
    targetSection.classList.add('active');
  }
}

function selectMainIdeaChoice(choiceIndex) {
  document.querySelectorAll('.main-idea-choice').forEach(choice => {
    choice.classList.remove('selected');
  });
  document.querySelector(`[data-choice="${choiceIndex}"]`).classList.add('selected');
}

function checkMainIdea() {
  const selected = document.querySelector('.main-idea-choice.selected');
  const story = storyData[currentStory][currentLevel];
  const feedback = document.getElementById('mainIdeaFeedback');
  
  if (!selected) {
    feedback.className = 'feedback error show';
    feedback.innerHTML = '<strong>Please select an answer first!</strong>';
    return;
  }
  
  const selectedIndex = parseInt(selected.dataset.choice);
  const isCorrect = selectedIndex === story.mainIdea.correct;
  
  // Mark all choices
  document.querySelectorAll('.main-idea-choice').forEach((choice, index) => {
    choice.classList.remove('correct', 'incorrect');
    if (index === story.mainIdea.correct) {
      choice.classList.add('correct');
    } else if (choice.classList.contains('selected')) {
      choice.classList.add('incorrect');
    }
  });
  
  if (isCorrect) {
    feedback.className = 'feedback success show';
    feedback.innerHTML = '<strong>üéâ Excellent!</strong> You correctly identified the main idea!';
  } else {
    feedback.className = 'feedback error show';
    feedback.innerHTML = '<strong>Not quite.</strong> The correct answer is highlighted in green. The main idea tells what the whole story is mostly about.';
  }
}

function showContextHelp(index) {
  const helpSection = document.getElementById(`contextHelp_${index}`);
  helpSection.classList.add('show');
}

function checkContextAnswer(index) {
  const input = document.getElementById(`context_${index}`);
  const feedback = document.getElementById(`contextFeedback_${index}`);
  const story = storyData[currentStory][currentLevel];
  const item = story.contextClues[index];
  
  if (input.value.trim() === '') {
    feedback.className = 'feedback error show';
    feedback.innerHTML = '<strong>Please write your answer first!</strong>';
    return;
  }
  
  feedback.className = 'feedback success show';
  feedback.innerHTML = `
    <strong>Your answer:</strong> "${input.value}"<br>
    <strong>Sample answer:</strong> "${item.answer}"<br>
    <em>Great job using context clues! Even if your words are different, you likely understood the meaning.</em>
  `;
}

function showSequenceHelp(index) {
  const starterEl = document.getElementById(`starter_${index}`);
  const story = storyData[currentStory][currentLevel];
  const expanded = story.sequence[index].expanded;
  
  starterEl.textContent = expanded;
  starterEl.classList.add('expanded');
}

function checkSequence() {
  const inputs = document.querySelectorAll('[id^="sequence_"]');
  let completedSteps = 0;
  let feedback = [];
  
  inputs.forEach((input, index) => {
    if (input.value.trim() !== '') {
      completedSteps++;
    } else {
      feedback.push(`Step ${index + 1} needs to be completed`);
    }
  });
  
  const feedbackEl = document.getElementById('sequenceFeedback');
  
  if (completedSteps === inputs.length) {
    feedbackEl.className = 'feedback success show';
    feedbackEl.innerHTML = `
      <strong>üéâ Great job!</strong> You retold the story in sequence using the sentence starters. 
      This shows you understand the order of events in the story!
    `;
  } else {
    feedbackEl.className = 'feedback error show';
    feedbackEl.innerHTML = `
      <strong>Almost there!</strong> You completed ${completedSteps} out of ${inputs.length} steps.<br>
      ${feedback.join('<br>')}
    `;
  }
}

function showComprehensionHint(index) {
  const hintSection = document.getElementById(`comprehensionHint_${index}`);
  hintSection.classList.add('show');
}

function checkComprehensionAnswer(index) {
  const input = document.getElementById(`comprehension_${index}`);
  const feedback = document.getElementById(`comprehensionFeedback_${index}`);
  const story = storyData[currentStory][currentLevel];
  const question = story.comprehension[index];
  
  if (input.value.trim() === '') {
    feedback.className = 'question-feedback error show';
    feedback.innerHTML = '<strong>Please write your answer first!</strong>';
    return;
  }
  
  feedback.className = 'question-feedback success show';
  feedback.innerHTML = `
    <strong>Your answer:</strong> "${input.value}"<br>
    <strong>Sample answer:</strong> "${question.answer}"<br>
    <em>Compare your answer with the sample. For inferential questions, there may be multiple correct ways to express the same idea.</em>
  `;
}

function checkComprehension() {
  const inputs = document.querySelectorAll('[id^="comprehension_"]');
  let completedAnswers = 0;
  let feedback = [];
  
  inputs.forEach((input, index) => {
    if (input.value.trim() !== '') {
      completedAnswers++;
    } else {
      feedback.push(`Question ${index + 1} needs an answer`);
    }
  });
  
  const feedbackEl = document.getElementById('comprehensionFeedback');
  
  if (completedAnswers === inputs.length) {
    feedbackEl.className = 'feedback success show';
    feedbackEl.innerHTML = `
      <strong>Well done!</strong> You answered all ${inputs.length} comprehension questions. 
      Review the individual feedback for each question to see how your answers compare to the sample responses.
    `;
  } else {
    feedbackEl.className = 'feedback error show';
    feedbackEl.innerHTML = `
      <strong>Almost finished!</strong> You completed ${completedAnswers} out of ${inputs.length} questions.<br>
      ${feedback.join('<br>')}
    `;
  }
}

function resetCurrentActivity() {
  if (currentActivity === 'main-idea') {
    document.querySelectorAll('.main-idea-choice').forEach(choice => {
      choice.classList.remove('selected', 'correct', 'incorrect');
    });
    document.getElementById('mainIdeaFeedback').classList.remove('show');
  } else if (currentActivity === 'context-clues') {
    document.querySelectorAll('[id^="context_"]').forEach(input => {
      input.value = '';
    });
    document.querySelectorAll('[id^="contextFeedback_"]').forEach(feedback => {
      feedback.classList.remove('show');
    });
    document.querySelectorAll('[id^="contextHelp_"]').forEach(help => {
      help.classList.remove('show');
    });
  } else if (currentActivity === 'sequence') {
    document.querySelectorAll('[id^="sequence_"]').forEach(input => {
      input.value = '';
    });
    document.querySelectorAll('[id^="starter_"]').forEach(starter => {
      starter.classList.remove('expanded');
      // Reset to basic starter text
      const index = parseInt(starter.id.split('_')[1]);
      const story = storyData[currentStory][currentLevel];
      starter.textContent = story.sequence[index].basic;
    });
    document.getElementById('sequenceFeedback').classList.remove('show');
  } else if (currentActivity === 'comprehension') {
    document.querySelectorAll('[id^="comprehension_"]').forEach(input => {
      input.value = '';
    });
    document.querySelectorAll('[id^="comprehensionFeedback_"]').forEach(feedback => {
      feedback.classList.remove('show');
    });
    document.querySelectorAll('[id^="comprehensionHint_"]').forEach(hint => {
      hint.classList.remove('show');
    });
    document.getElementById('comprehensionFeedback').classList.remove('show');
  }
}
</script>
</body>
</html>