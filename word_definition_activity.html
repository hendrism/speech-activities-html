<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Definition Activity</title>
    <script>
        // Configuration for the Universal Quiz
        window.activityType = 'definitions';
    </script>
</head>

<body>
    <!-- Load the Universal Quiz Template -->
    <!-- 
         Since we are in a flat file system, we can't easily "include" HTML.
         However, we can use an iframe OR just copy the template code here but keep it minimal.
         
         ACTUALLY, the best way for a static site refactor without a build step is to:
         1. Make this file a redirect? No, that's jarring.
         2. Make this file load the content dynamically.
         
         Let's use the "Loader" pattern.
         We will fetch the universal-quiz.html content? No, CORS issues with file://.
         
         BETTER APPROACH:
         We will just put the "Universal Quiz" HTML structure HERE, but it's identical in both files.
         Wait, that defeats the purpose of a "Template".
         
         The user wants "Developer Efficiency".
         If I copy-paste the template into both files, I have 2 copies to maintain.
         
         Solution: `universal-quiz.html` IS the app.
         These files (`word_definition_activity.html`) should just be redirects or wrappers.
         
         "window.location.replace('universal-quiz.html?type=definitions')"
         
         Let's try the iframe approach for seamless integration if they want to keep the URL.
         OR just use the JS module to render everything into the body.
    -->

    <div id="app-root"></div>

    <script type="module">
        // We can import the logic and render it.
        // This means `universal-quiz.html` isn't strictly needed as a file if we have the JS.
        // BUT having a standalone HTML file is good for testing.

        // Let's re-use the logic we wrote in universal-quiz.html but imported here.
        // I will duplicate the minimal HTML structure here and import the engine.

        import { wordDefinitions } from './js/language-data.js';
        import { QuizEngine } from './js/quiz-engine.js';

        document.body.innerHTML = `
            <link rel="stylesheet" href="css/styles.css">
            <div class="app-container">
                <header class="main-header">
                    <div class="header-content">
                        <h1>ðŸŽ¯ Word Definition Activity</h1>
                        <p>Match the words to their meanings</p>
                    </div>
                </header>
                <main class="content-area">
                    <div id="activity-container"></div>
                </main>
            </div>
        `;

        // Add specific styles for the quiz
        const style = document.createElement('style');
        style.textContent = `
            .quiz-card { background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-top: 20px; }
            .question-text { font-size: 1.2em; margin-bottom: 20px; line-height: 1.6; }
            .target-word { color: var(--primary-color); font-weight: bold; background: #e0e7ff; padding: 2px 6px; border-radius: 4px; }
            .options-grid { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 20px; }
            .option-btn { padding: 15px; border: 2px solid #e2e8f0; border-radius: 8px; background: white; cursor: pointer; font-size: 1em; text-align: left; transition: all 0.2s; }
            .option-btn:hover { border-color: var(--primary-color); background: #f8fafc; }
            .option-btn.correct { background: #dcfce7; border-color: #22c55e; color: #166534; }
            .option-btn.incorrect { background: #fee2e2; border-color: #ef4444; color: #991b1b; }
            .feedback-area { margin-top: 20px; padding: 15px; border-radius: 8px; display: none; }
            .hint-box { margin-top: 15px; padding: 15px; background: #fffbeb; border-left: 4px solid #f59e0b; border-radius: 4px; display: none; }
            .controls { display: flex; justify-content: space-between; margin-top: 30px; }
        `;
        document.head.appendChild(style);

        const engine = new QuizEngine({
            data: wordDefinitions,
            containerId: 'activity-container',
            onRender: (item, progress, engine) => {
                const card = document.createElement('div');
                card.className = 'quiz-card';

                // Shuffle choices
                const choices = engine.shuffleArray(item.categoryChoices);
                const correctAnswer = item.category;

                const optionsHtml = choices.map(choice =>
        \`<button class="option-btn" onclick="window.checkAnswer(this, '\${choice.replace(/'/g, "\\\\'")}', '\${correctAnswer.replace(/'/g, "\\\\'")}')">\${choice}</button>\`
                ).join('');

                card.innerHTML = \`
                    <div class="progress-container" style="margin-bottom: 20px;">
                        <div class="progress-bar" style="width: \${progress.percent}%"></div>
                        <div style="text-align: right; font-size: 0.9em; color: #666; margin-top: 5px;">
                            Question \${progress.current} of \${progress.total}
                        </div>
                    </div>
                    <div class="question-text">
                        What is the definition of <span class="target-word">\${item.word}</span>?
                    </div>
                    <div class="hint-box" id="hint-box">
                        <strong>ðŸ’¡ Hint:</strong> \${item.categoryHint}
                    </div>
                    <div class="options-grid">
                        \${optionsHtml}
                    </div>
                    <div class="feedback-area" id="feedback-area"></div>
                    <div class="controls">
                        <button class="btn btn-secondary" onclick="window.toggleHint()">ðŸ’¡ Hint</button>
                        <button class="btn btn-primary" id="next-btn" style="display:none;" onclick="window.nextQuestion()">Next âž¡</button>
                    </div>
                \`;
                return card;
            }
        });

        window.checkAnswer = (btn, selected, correct) => {
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.disabled = true);
            const feedback = document.getElementById('feedback-area');
            feedback.style.display = 'block';

            if (selected === correct) {
                btn.classList.add('correct');
                feedback.textContent = "ðŸŽ‰ Correct! Great job.";
                feedback.style.background = "#dcfce7";
                feedback.style.color = "#166534";
            } else {
                btn.classList.add('incorrect');
                allBtns.forEach(b => { if (b.textContent === correct) b.classList.add('correct'); });
                feedback.textContent = "Not quite. The correct answer is highlighted.";
                feedback.style.background = "#fee2e2";
                feedback.style.color = "#991b1b";
            }
            document.getElementById('next-btn').style.display = 'block';
        };

        window.toggleHint = () => {
            const hint = document.getElementById('hint-box');
            hint.style.display = hint.style.display === 'none' ? 'block' : 'none';
        };

        window.nextQuestion = () => {
            engine.next();
        };
    </script>
</body>

</html>